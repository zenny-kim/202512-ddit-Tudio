<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ê²Œì‹œê¸€ ì¡°íšŒ</title>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<link rel="stylesheet" href="${pageContext.request.contextPath}/css/sidebar.css">
<link rel="stylesheet" href="${pageContext.request.contextPath}/css/header.css">
<link rel="stylesheet" href="${pageContext.request.contextPath}/css/footer.css">
<link rel="stylesheet" href="${pageContext.request.contextPath}/css/member.css">
<link rel="stylesheet" href="${pageContext.request.contextPath}/css/boardselect.css">
</head>

<body>
<jsp:include page="/WEB-INF/views/include/header_user.jsp"/>
<jsp:include page="/WEB-INF/views/include/sidebar_user.jsp"/>

<div class="bd-wrap">

  <!-- ìƒë‹¨: breadcrumb + ë²„íŠ¼ -->
  <div class="bd-topbar">
    <div class="bd-crumb">
      <a href="#">ê²Œì‹œíŒ</a>
      <span class="sep">/</span>
      <span class="current">ê¸€ ìƒì„¸</span>
    </div>

    <div class="bd-actions">
      <button type="button" class="bd-btn ghost" onclick="history.back()">
        <span class="icon">â‰¡</span> ëª©ë¡
      </button>
      <button type="button" class="bd-btn ghost">
        <span class="icon">âœ</span> ìˆ˜ì •
      </button>
      <button type="button" class="bd-btn danger">
        <span class="icon">ğŸ—‘</span> ì‚­ì œ
      </button>
    </div>
  </div>

  <!-- ê²Œì‹œê¸€ ì¹´ë“œ -->
  <article class="bd-card">
    <header class="bd-head">
      <h1 class="bd-title">íšŒì˜ë¡ ê³µìœ ë“œë¦½ë‹ˆë‹¤. (12/20)</h1>

      <div class="bd-meta">
        <span class="bd-chip">íšŒì˜ë¡</span>
        <span class="dot">â€¢</span>
        <span>ë°•ê°€ëŒ</span>
        <span class="dot">â€¢</span>
        <time>2025.12.20 14:00</time>
        <span class="dot">â€¢</span>
        <span>ì¡°íšŒ 45</span>
        <span class="dot">â€¢</span>
        <span>ëŒ“ê¸€ 2</span>

        <div class="bd-status">
          <span class="bd-badge warn">í™•ì¸ì¤‘</span>
          <span class="bd-badge ok">í™•ì¸ì™„ë£Œ</span>
        </div>
      </div>
    </header>

    <div class="bd-body">
      <p>ì•ˆë…•í•˜ì„¸ìš”, ë°•ê°€ëŒì…ë‹ˆë‹¤.</p>
      <p>ê¸ˆì¼ ì§„í–‰ëœ ì£¼ê°„ ì—…ë¬´ íšŒì˜ë¡ ê³µìœ ë“œë¦½ë‹ˆë‹¤.</p>
      <p>ì£¼ìš” ê²°ì • ì‚¬í•­ ë° ë‹¤ìŒ ì£¼ ìŠ¤í”„ë¦°íŠ¸ ëª©í‘œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. íŒ€ì› ë¶„ë“¤ì€ í™•ì¸ ë¶€íƒë“œë¦½ë‹ˆë‹¤.</p>

      <ol>
        <li>ë¡œê·¸ì¸ API ì¸ì¦ ìŠ¤ì¼€ì¤„ ì¡°ì •</li>
        <li>ë””ìì¸ QA ì¼ì • í™•ì •</li>
      </ol>
    </div>

    <section class="bd-attach">
      <div class="bd-attach-title">ì²¨ë¶€íŒŒì¼ <span class="count">(1)</span></div>

      <a class="bd-file" href="#" download>
        <div class="file-ico">ğŸ“</div>
        <div class="file-meta">
          <div class="file-name">íšŒì˜ë¡_20251220.docx</div>
          <div class="file-sub">15 KB</div>
        </div>
        <div class="file-down">ë‹¤ìš´ë¡œë“œ</div>
      </a>
    </section>
  </article>

  <!-- ëŒ“ê¸€ ì¹´ë“œ -->
  <section class="cm-card">
    <div class="cm-head">
      <div class="cm-title">ëŒ“ê¸€ <span class="count">(2)</span></div>
    </div>

    <!--  ëŒ“ê¸€ ì‘ì„±: ë²„íŠ¼ì„ ì•„ë˜ë¡œ ë‚´ë¦¼ -->
    <div class="cm-write">
      <div class="avatar">ë‚˜</div>

      <div class="cm-write-box">
        <textarea id="cmtContent" placeholder="ëŒ“ê¸€ì„ ë‚¨ê²¨ë³´ì„¸ìš”"></textarea>

        <div class="cm-write-actions bottom">
          <button type="button" class="bd-btn primary xs" id="cmtSubmit">ë“±ë¡</button>
        </div>
      </div>
    </div>

    <div class="cm-list">

      <!-- ëŒ“ê¸€ 1 -->
      <article class="cm-item" data-cmt-id="101">
        <div class="cm-row">
          <div class="avatar blue">ê¹€</div>

          <div class="cm-main">

            <div class="cm-meta">
              <strong class="name">ê¹€íŒ€ì¥(a002)</strong>
              <time class="time">2025.12.20 14:10</time>

              <div class="cm-meta-actions">
                <button type="button" class="cm-link">ìˆ˜ì •</button>
                <button type="button" class="cm-link danger">ì‚­ì œ</button>
              </div>
            </div>

            <div class="cm-text">
              ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤. ì´ìŠˆ 2ê±´ì€ ì œê°€ ë”°ë¡œ í™•ì¸í• ê²Œìš”.
            </div>

            <div class="cm-actions">
              <button type="button" class="cm-link" data-action="toggle-replies">
                ë‹µê¸€(<span class="reply-count">1</span>)
              </button>
            </div>

            <!--  1) ë‹µê¸€ ë¦¬ìŠ¤íŠ¸ë¥¼ ë¨¼ì € -->
            <div class="replies is-hidden">
              <article class="rp-item">
                <div class="avatar sky">ë°•</div>
                <div class="rp-main">
                  <div class="cm-meta">
                    <strong class="name">ë°•ê°€ëŒ(ë‚˜)</strong>
                    <time class="time">2025.12.20 14:15</time>

                    <div class="cm-meta-actions">
                      <button type="button" class="cm-link">ìˆ˜ì •</button>
                      <button type="button" class="cm-link danger">ì‚­ì œ</button>
                    </div>
                  </div>

                  <div class="cm-text">ë„µ! ì•Œê² ìŠµë‹ˆë‹¤. í™•ì¸ ê°ì‚¬í•©ë‹ˆë‹¤.</div>
                </div>
              </article>
            </div>

            <!-- 2) ë§¨ ì•„ë˜ì— ë‹µê¸€ ì…ë ¥ì°½ -->
            <div class="reply-write is-hidden">
              <textarea class="reply-text" placeholder="ë‹µê¸€ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
              <div class="reply-actions">
                <button type="button" class="bd-btn ghost xs" data-action="cancel-reply">ì·¨ì†Œ</button>
                <button type="button" class="bd-btn primary xs" data-action="submit-reply">ë“±ë¡</button>
              
              </div>
            </div>

          </div>
        </div>
      </article>

      <!-- ëŒ“ê¸€ 2 -->
      <article class="cm-item" data-cmt-id="102">
        <div class="cm-row">
          <div class="avatar gray">(í”„ë¡œí•„ ì‚¬ì§„ ë„£ê¸°)</div>

          <div class="cm-main">

            <div class="cm-meta">
              <strong class="name">ì„ëŒ€ë¦¬(a001)</strong>
              <time class="time">2025.12.20 14:30</time>

              <div class="cm-meta-actions">
                <button type="button" class="cm-link">ìˆ˜ì •</button>
                <button type="button" class="cm-link danger">ì‚­ì œ</button>
              </div>
            </div>

            <div class="cm-text">íšŒì˜ë¡ í™•ì¸í–ˆìŠµë‹ˆë‹¤. ì¼ì • ë¶€ë¶„ì€ ì œ ìª½ì—ì„œ ê³µìœ ë“œë¦´ê²Œìš”.</div>

            <div class="cm-actions">
              <button type="button" class="cm-link" data-action="toggle-replies">
                ë‹µê¸€(<span class="reply-count">0</span>)
              </button>
            </div>

            <!-- ë‹µê¸€ ë¦¬ìŠ¤íŠ¸ ë¨¼ì € -->
            <div class="replies is-hidden"></div>

            <!-- ë‹µê¸€ ì…ë ¥ ë§¨ ì•„ë˜ -->
            <div class="reply-write is-hidden">
              <textarea class="reply-text" placeholder="ë‹µê¸€ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
              <div class="reply-actions">
                <button type="button" class="bd-btn ghost xs" data-action="cancel-reply">ì·¨ì†Œ</button>
                <button type="button" class="bd-btn primary xs" data-action="submit-reply">ë“±ë¡</button>
              </div>
            </div>

          </div>
        </div>
      </article>

    </div>
  </section>

</div>

<jsp:include page="/WEB-INF/views/include/footer.jsp"/>
<script src="${pageContext.request.contextPath}/js/footer.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>


<!-- ëŒ“ê¸€ ë“±ë¡: FormDataì— content, boNo, file(ì„ íƒ) ë‹´ì•„ì„œ ì „ì†¡
ëŒ€ëŒ“ê¸€ ë“±ë¡: FormDataì— parentCmtId(= data-cmt-id), content, file(ì„ íƒ) ë‹´ì•„ì„œ ì „ì†¡
processData:false, contentType:false í•„ìˆ˜ -->


<script type="text/javascript">
$(function () {

  function close($keepItem){
    $(".cm-item").each(function(){
      const $item = $(this);
      if ($keepItem && $item.is($keepItem)) return;

      $item.find(".replies").first().addClass("is-hidden");
      $item.find(".reply-write").first().addClass("is-hidden");
      $item.find(".reply-write textarea").val("");
    });
  }

  //  ë‹µê¸€ ë²„íŠ¼: í•œ ë²ˆì— í•˜ë‚˜ë§Œ ì—´ë¦¬ê²Œ + ë¦¬ìŠ¤íŠ¸ ë¨¼ì € ë³´ì´ê³  ì…ë ¥ì€ ë§¨ ì•„ë˜
  $(document).on("click", '[data-action="toggle-replies"]', function () {
    const $cmItem   = $(this).closest(".cm-item");
    const $replies  = $cmItem.find(".replies").first();
    const $replyBox = $cmItem.find(".reply-write").first();

    const willOpen = $replies.hasClass("is-hidden");

    if (willOpen) {
    	close($cmItem);
      $replies.removeClass("is-hidden");
      $replyBox.removeClass("is-hidden");
      $replyBox.find("textarea").focus();
    } else {
      $replies.addClass("is-hidden");
      $replyBox.addClass("is-hidden");
      $replyBox.find("textarea").val("");
    }
  });

  // ì·¨ì†Œ: í˜„ì¬ ëŒ“ê¸€ì˜ ë‹µê¸€ ì…ë ¥ë§Œ ë‹«ê¸°(ë‹µê¸€ ë¦¬ìŠ¤íŠ¸ëŠ” ê·¸ëŒ€ë¡œ)
  $(document).on("click", '[data-action="cancel-reply"]', function () {
    const $cmItem   = $(this).closest(".cm-item");
    const $replyBox = $cmItem.find(".reply-write").first();
    $replyBox.addClass("is-hidden");
    $replyBox.find("textarea").val("");
  });

});
</script>

</body>
</html>
