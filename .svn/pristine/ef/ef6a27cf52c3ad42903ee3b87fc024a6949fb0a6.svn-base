import{r,j as e,a as R,l as D,W as I,Y as U,Z as z}from"./common.chunk.js";const B=({refreshTrigger:x})=>{const[d,y]=r.useState([]),[k,u]=r.useState(""),[v,S]=r.useState(""),[g,a]=r.useState([]),[N,T]=r.useState(!0),f=i=>{switch(parseInt(i)){case 201:return{text:"ìš”ì²­",color:"bg-secondary"};case 202:return{text:"ì§„í–‰",color:"bg-primary"};case 203:return{text:"ì™„ë£Œ",color:"bg-success"};case 204:return{text:"ë³´ë¥˜",color:"bg-dark"};case 205:return{text:"ì§€ì—°",color:"bg-danger"};default:return{text:"ë¯¸ì •",color:"bg-secondary"}}},n=()=>{const i=new Date,c=i.getTimezoneOffset()*6e4;return new Date(i-c).toISOString().split("T")[0]},h=r.useCallback(i=>{const c=new Date,C=new Date(c);C.setDate(c.getDate()-c.getDay());const O=[],M=["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "];for(let $=0;$<7;$++){const P=new Date(C);P.setDate(C.getDate()+$);const s=P.getFullYear(),p=String(P.getMonth()+1).padStart(2,"0"),E=String(P.getDate()).padStart(2,"0"),b=`${s}-${p}-${E}`,l=i.find(L=>L.WORK_DATE_STR===b),w=l?l.DAILY_COUNT:0;O.push({dateStr:b,dayNum:E,dayName:M[$],count:w})}a(O)},[]),m=async(i=!1)=>{try{const c=await R.get("/tudio/dashboard/personalWork"),{list:C,titleRange:O}=c.data;y(C||[]),u(O),h(C||[]),i&&S(n())}catch(c){console.error("ê°œì¸ì—…ë¬´ ë¡œë“œ ì‹¤íŒ¨",c)}finally{T(!1)}};r.useEffect(()=>{m(!0)},[]),r.useEffect(()=>{x>0&&(console.log("â™»ï¸ [ê°œì¸ì—…ë¬´] ê°±ì‹  ì‹ í˜¸ ìˆ˜ì‹  -> ì¬ì¡°íšŒ"),m(!1))},[x]);const j=d.filter(i=>i.WORK_DATE_STR===v),o=i=>{window.location.href=`/tudio/project/detail?projectNo=${i.PROJECT_NO}&taskId=${i.WORK_ID}`},t=(i,c)=>{i.stopPropagation(),window.location.href=`/tudio/project/detail?projectNo=${c}`};return N?e.jsx("div",{className:"text-center py-4",children:e.jsx("span",{className:"spinner-border spinner-border-sm text-primary"})}):e.jsxs("div",{className:"widget-content d-flex flex-column h-100 overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 p-3 pb-0",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("h6",{className:"fw-bold m-0 text-dark",children:[e.jsx("i",{className:"bi bi-calendar-check text-primary me-2"}),"ê°œì¸ ì—…ë¬´"]}),e.jsx("span",{className:"badge bg-light text-secondary border",children:k})]}),e.jsx("div",{className:"d-flex justify-content-between text-center bg-light rounded p-2 mt-3 mb-3",children:g.map((i,c)=>{const C=v===i.dateStr,O=c===0?"text-danger":c===6?"text-primary":"text-dark";return e.jsxs("div",{onClick:()=>S(i.dateStr),className:`calendar-day-box flex-fill p-1 rounded cursor-pointer position-relative ${C?"bg-white shadow-sm border border-primary":""}`,children:[e.jsx("div",{className:`small ${c===0||c===6?O:"text-muted"}`,style:{fontSize:"0.7rem"},children:i.dayName}),e.jsxs("div",{className:`fw-bold mt-1 ${O}`,children:[i.dayNum,i.count>0&&e.jsxs("span",{className:"ms-1 text-primary small",style:{fontSize:"0.75rem",verticalAlign:"top"},children:["[",i.count,"]"]})]})]},i.dateStr)})})]}),e.jsxs("div",{className:"flex-grow-1 overflow-auto custom-scrollbar px-3",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("h6",{className:"small text-muted border-bottom pb-2 mt-3 mb-2",children:["ğŸ“… ",v," (",j.length,"ê±´)"]}),e.jsxs("div",{className:"info-icon-wrapper",children:[e.jsx("i",{className:"bi bi-info-circle text-secondary"}),e.jsxs("div",{className:"info-tooltip",children:[e.jsxs("div",{className:"d-flex align-items-center mb-1",children:[e.jsx("i",{className:"bi bi-bookmark-fill text-primary me-2"})," ìƒìœ„ ì—…ë¬´"]}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-arrow-return-right text-muted me-2"})," í•˜ìœ„ ì—…ë¬´"]})]})]})]}),j.length===0?e.jsx("div",{className:"text-center text-muted py-4 small",children:"ì˜ˆì •ëœ ì—…ë¬´ê°€ ì—†ìŠµë‹ˆë‹¤."}):e.jsx("ul",{className:"list-group list-group-flush px-0 py-0",children:j.map((i,c)=>{const C=f(i.WORK_STATUS);return e.jsxs("li",{className:"list-group-item px-2 py-2 border-0 d-flex align-items-center list-group-item-action",onClick:()=>o(i),style:{cursor:"pointer"},children:[e.jsx("span",{className:"badge bg-light text-dark border me-2 text-truncate",style:{maxWidth:"80px",cursor:"pointer"},onClick:O=>t(O,i.PROJECT_NO),title:"í”„ë¡œì íŠ¸ë¡œ ì´ë™",children:i.PROJECT_NAME}),e.jsxs("div",{className:"text-truncate flex-grow-1 small fw-bold text-dark",title:i.WORK_TITLE,children:[i.WORK_TYPE==="TASK"?e.jsx("i",{className:"bi bi-bookmark-fill text-primary me-1",style:{fontSize:"0.7rem"}}):e.jsx("i",{className:"bi bi-arrow-return-right text-muted me-1",style:{fontSize:"0.7rem"}}),i.WORK_TITLE]}),e.jsx("span",{className:`badge ${C.color} ms-2`,style:{minWidth:"50px"},children:C.text})]},c)})})]}),e.jsx("div",{className:"flex-shrink-0 py-2 px-3 border-top text-end",children:e.jsxs("span",{className:"text-muted small",style:{fontSize:"0.75rem"},children:[e.jsx("i",{className:"bi bi-check2-circle me-1"}),"ì˜¤ëŠ˜ ì™„ë£Œ: ",e.jsxs("span",{className:"fw-bold",children:[d.filter(i=>i.WORK_DATE_STR===n()&&i.WORK_STATUS==203).length,"ê±´"]})]})})]})},F=({refreshTrigger:x})=>{const[d,y]=r.useState({stats:{PENDING_COUNT:0,CONFIRM_COUNT:0,APPROVE_COUNT:0,REJECT_COUNT:0,WAIT_COUNT:0,PROG_COUNT:0,APPROVED_COUNT:0},myDrafts:[],toApprove:[],isClient:!1}),[k,u]=r.useState(!1),[v,S]=r.useState(null),[g,a]=r.useState(null),N=async()=>{try{const i=(await R.get("/tudio/dashboard/approval/data")).data||{},c=i.isClient;y({stats:i.stats||{},myDrafts:i.myDrafts||[],toApprove:i.toApprove||[],isClient:c})}catch(t){console.error("ê²°ì¬ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨",t)}finally{u(!1)}};r.useEffect(()=>{N()},[]),r.useEffect(()=>{x>0&&(console.log("â™»ï¸ [ì „ìê²°ì¬] ê°±ì‹  ì‹ í˜¸ ìˆ˜ì‹  -> ì¬ì¡°íšŒ"),N())},[x]);const T=t=>{window.location.href=`/tudio/approval/detail?documentNo=${t}`};let f=[],n="",h="";d.isClient?(n="ê²°ì¬ ê¸°ì•ˆ",f=d.toApprove,g==="PENDING"&&(f=f.filter(t=>t.documentStatus===607)),g==="CONFIRM"&&(f=f.filter(t=>t.documentStatus===608)),g==="APPROVE"&&(f=f.filter(t=>t.documentStatus===609)),g==="REJECT"&&(f=f.filter(t=>t.documentStatus===610)),h=g?"í•´ë‹¹ ìƒíƒœì˜ ê¸°ì•ˆì„œê°€ ì—†ìŠµë‹ˆë‹¤.":"ìš”ì²­ëœ ê²°ì¬ ê¸°ì•ˆì„œê°€ ì—†ìŠµë‹ˆë‹¤."):(n="ê¸°ì•ˆ í˜„í™©",f=d.myDrafts,g==="WAIT"&&(f=f.filter(t=>t.documentStatus===611)),g==="PROG"&&(f=f.filter(t=>t.documentStatus===612)),g==="REJECT"&&(f=f.filter(t=>t.documentStatus===614)),g==="APPROVED"&&(f=f.filter(t=>t.documentStatus===613)),h=g?"í•´ë‹¹ ìƒíƒœì˜ ê¸°ì•ˆì„œê°€ ì—†ìŠµë‹ˆë‹¤.":"ì‘ì„±í•œ ê¸°ì•ˆì„œê°€ ì—†ìŠµë‹ˆë‹¤.");const m=t=>{a(g===t?null:t)},j=t=>{const i=parseInt(t),c={minWidth:"60px"};switch(i){case 607:return e.jsx("span",{className:"badge bg-danger rounded-pill",style:c,children:"ë¯¸ê²°"});case 608:return e.jsx("span",{className:"badge bg-primary rounded-pill",style:c,children:"í™•ì¸"});case 609:return e.jsx("span",{className:"badge bg-success rounded-pill",style:c,children:"ìŠ¹ì¸"});case 610:return e.jsx("span",{className:"badge bg-secondary rounded-pill",style:c,children:"ë°˜ë ¤"});case 611:return e.jsx("span",{className:"badge bg-secondary rounded-pill",style:c,children:"ìŠ¹ì¸ëŒ€ê¸°"});case 612:return e.jsx("span",{className:"badge bg-primary rounded-pill",style:c,children:"ì§„í–‰ì¤‘"});case 613:return e.jsx("span",{className:"badge bg-success rounded-pill",style:c,children:"ìµœì¢…ìŠ¹ì¸"});case 614:return e.jsx("span",{className:"badge bg-danger rounded-pill",style:c,children:"ë°˜ë ¤"});case 615:return e.jsx("span",{className:"badge bg-pending rounded-pill",style:c,children:"íšŒìˆ˜"});case 616:return e.jsx("span",{className:"badge bg-light text-dark border rounded-pill",style:c,children:"ì„ì‹œë³´ê´€"});default:return e.jsx("span",{className:"badge bg-light text-dark border rounded-pill",style:c,children:"-"})}},o=t=>{switch(parseInt(t)){case 601:return"ìì›/ì¸ë ¥ ìš”ì²­";case 602:return"ì¼ì •ë³€ê²½ ìš”ì²­";case 603:return"ì˜ˆì‚°ì¡°ì • ìš”ì²­";case 604:return"ê²€ìˆ˜ë°ë³´ê³ ";case 605:return"ìµœì¢…ì™„ë£Œë³´ê³ ";case 606:return"ê¸°íƒ€";default:return"ì¼ë°˜ê¸°ì•ˆ"}};return k?e.jsx("div",{className:"text-center py-4",children:e.jsx("span",{className:"spinner-border spinner-border-sm text-primary"})}):e.jsxs("div",{className:"widget-content d-flex flex-column h-100 overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 p-3 d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"fw-bold m-0 text-dark",children:[e.jsx("i",{className:"bi bi-file-earmark-check-fill me-2 text-success"}),n]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsxs("span",{className:"badge bg-light text-secondary border",children:[f.length,"ê±´"]}),e.jsx("a",{href:"/tudio/approval/list",className:"text-muted small text-decoration-none ms-1",title:"ë”ë³´ê¸°",children:e.jsx("i",{className:"bi bi-plus-lg"})})]})]}),e.jsx("div",{className:"flex-shrink-0 d-flex border-bottom border-top text-center py-2 bg-light small mx-3 rounded mb-2",children:d.isClient?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`flex-fill border-end py-2 stats-item ${g==="PENDING"?"active":""}`,onClick:()=>m("PENDING"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"ë¯¸ê²°"}),e.jsx("strong",{className:"text-danger",children:d.stats.PENDING_COUNT||0})]}),e.jsxs("div",{className:`flex-fill border-end py-2 stats-item ${g==="CONFIRM"?"active":""}`,onClick:()=>m("CONFIRM"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"í™•ì¸"}),e.jsx("strong",{className:"text-primary",children:d.stats.CONFIRM_COUNT||0})]}),e.jsxs("div",{className:`flex-fill border-end py-2 stats-item ${g==="APPROVE"?"active":""}`,onClick:()=>m("APPROVE"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"ìŠ¹ì¸"}),e.jsx("strong",{className:"text-success",children:d.stats.APPROVE_COUNT||0})]}),e.jsxs("div",{className:`flex-fill py-2 stats-item ${g==="REJECT"?"active":""}`,onClick:()=>m("REJECT"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"ë°˜ë ¤"}),e.jsx("strong",{className:"text-secondary",children:d.stats.REJECT_COUNT||0})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`flex-fill border-end py-2 stats-item ${g==="WAIT"?"active":""}`,onClick:()=>m("WAIT"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"ëŒ€ê¸°"}),e.jsx("strong",{className:"text-secondary",children:d.stats.WAIT_COUNT||0})]}),e.jsxs("div",{className:`flex-fill border-end py-2 stats-item ${g==="PROG"?"active":""}`,onClick:()=>m("PROG"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"ì§„í–‰"}),e.jsx("strong",{className:"text-primary",children:d.stats.PROG_COUNT||0})]}),e.jsxs("div",{className:`flex-fill border-end py-2 stats-item ${g==="REJECT"?"active":""}`,onClick:()=>m("REJECT"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"ë°˜ë ¤"}),e.jsx("strong",{className:"text-danger",children:d.stats.REJECT_COUNT||0})]}),e.jsxs("div",{className:`flex-fill py-2 stats-item ${g==="APPROVED"?"active":""}`,onClick:()=>m("APPROVED"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"ìŠ¹ì¸"}),e.jsx("strong",{className:"text-success",children:d.stats.APPROVED_COUNT||0})]})]})}),e.jsx("div",{className:"flex-grow-1 overflow-y-auto custom-scrollbar px-3",style:{minHeight:0},children:f.length===0?e.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center h-75 text-muted small",children:[e.jsx("i",{className:"bi bi-inbox fs-4 mb-2 opacity-50"}),e.jsx("span",{children:h})]}):e.jsx("ul",{className:"list-group list-group-flush pb-2",children:f.map(t=>e.jsxs("li",{className:"list-group-item list-group-item-action py-2 px-2 border-bottom d-flex justify-content-between align-items-center cursor-pointer border-0",onClick:()=>T(t.documentNo),style:{cursor:"pointer"},children:[e.jsx("div",{className:"text-truncate me-2",style:{flex:1},children:e.jsxs("div",{className:"d-flex align-items-center mb-1",children:[e.jsx("span",{className:"badge bg-light text-dark border me-2 text-truncate",style:{fontSize:"0.6rem"},children:o(t.documentType)}),e.jsx("span",{className:"fw-bold text-dark text-truncate small me-2",title:t.documentTitle,children:t.documentTitle}),e.jsxs("span",{className:"text-muted small",style:{fontSize:"0.75rem"},children:["[",d.isClient&&e.jsxs("span",{children:[e.jsx("i",{className:"bi bi-person me-1"}),t.drafterName," / "]}),t.documentRegdate,"]"]})]})}),e.jsx("div",{className:"flex-shrink-0",children:d.isClient&&t.documentStatus===607?e.jsx("button",{className:"btn btn-sm btn-outline-danger py-0 px-2 fw-bold",style:{fontSize:"0.75rem"},children:"ê²°ì¬"}):j(t.documentStatus)})]},t.documentNo))})}),e.jsx("div",{className:"flex-shrink-0 p-2 border-top text-end",style:{minHeight:"2rem"}})]})},K=({refreshTrigger:x})=>{const[d,y]=r.useState({stats:{ALL_COUNT:0,UNREAD_COUNT:0,READ_COUNT:0},list:[]}),[k,u]=r.useState(!1),[v,S]=r.useState("ALL"),g=D.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:o=>{o.addEventListener("mouseenter",D.stopTimer),o.addEventListener("mouseleave",D.resumeTimer)}}),a=async()=>{try{const t=(await R.get("/tudio/dashboard/alarm")).data||{};y({stats:t.stats||{ALL_COUNT:0,UNREAD_COUNT:0,READ_COUNT:0},list:Array.isArray(t.list)?t.list:[]})}catch(o){console.error("ì•Œë¦¼ ë¡œë“œ ì‹¤íŒ¨",o)}finally{u(!1)}};r.useEffect(()=>{a()},[]),r.useEffect(()=>{x>0&&(console.log("â™»ï¸ Alarm ë¦¬ìŠ¤íŠ¸ ê°±ì‹ "),a())},[x]);const N=o=>{if(!o)return"-";const t=new Date(o),i=String(t.getFullYear()).slice(-2),c=String(t.getMonth()+1).padStart(2,"0"),C=String(t.getDate()).padStart(2,"0");return`${i}.${c}.${C}`},T=async(o,t)=>{o.stopPropagation();try{await R.post("/tudio/noti/toggle",{notiNo:t}),a()}catch(i){console.error("ì•Œë¦¼ ìƒíƒœ ë³€ê²½ ì‹¤íŒ¨",i)}},f=async(o,t)=>{if(o.stopPropagation(),(await D.fire({title:"ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"ì‚­ì œ",cancelButtonText:"ì·¨ì†Œ",customClass:{popup:"small-swal"}})).isConfirmed)try{await R.post("/tudio/noti/delete",null,{params:{notiNo:t}}),a(),g.fire({icon:"success",title:"ì•Œë¦¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."})}catch{D.fire("ì‹¤íŒ¨","ì•Œë¦¼ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ","error")}},n=o=>{o&&(window.location.href=o)},h=o=>{S(o)};let m=d.list;v==="UNREAD"?m=d.list.filter(o=>o.isRead==="N"):v==="READ"&&(m=d.list.filter(o=>o.isRead==="Y"));let j="ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤.";return v==="UNREAD"&&m.length===0&&(j="ì•ˆ ì½ì€ ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤."),v==="READ"&&m.length===0&&(j="ì½ì€ ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤."),k?e.jsx("div",{className:"text-center py-4",children:e.jsx("span",{className:"spinner-border spinner-border-sm text-primary"})}):e.jsxs("div",{className:"widget-content d-flex flex-column h-100 overflow-hidden",children:[e.jsx("div",{className:"flex-shrink-0 p-3 pb-2 d-flex justify-content-between align-items-center",children:e.jsxs("h6",{className:"fw-bold m-0 text-dark",children:[e.jsx("i",{className:"bi bi-bell-fill me-2 text-warning"}),"ì•Œë¦¼"]})}),e.jsxs("div",{className:"flex-shrink-0 d-flex border-bottom border-top text-center bg-light small mx-3 rounded mb-2 overflow-hidden",children:[e.jsxs("div",{className:`flex-fill border-end py-2 stats-item ${v==="ALL"?"active":""}`,onClick:()=>h("ALL"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"ì „ì²´"}),e.jsx("strong",{className:"text-dark",children:d.stats.ALL_COUNT||0})]}),e.jsxs("div",{className:`flex-fill border-end py-2 stats-item ${v==="UNREAD"?"active":""}`,onClick:()=>h("UNREAD"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"ì•ˆì½ìŒ"}),e.jsx("strong",{className:"text-danger",children:d.stats.UNREAD_COUNT||0})]}),e.jsxs("div",{className:`flex-fill py-2 stats-item ${v==="READ"?"active":""}`,onClick:()=>h("READ"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"ì½ìŒ"}),e.jsx("strong",{className:"text-secondary",children:d.stats.READ_COUNT||0})]})]}),e.jsx("div",{className:"flex-grow-1 overflow-y-auto custom-scrollbar",style:{minHeight:0},children:m.length===0?e.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center h-100 text-muted small pb-4",children:[e.jsx("i",{className:"bi bi-bell-slash fs-4 mb-2 opacity-50"}),e.jsx("span",{className:"text-center text-muted small",children:j})]}):e.jsx("ul",{className:"list-group list-group-flush",children:m.map(o=>e.jsxs("li",{className:`list-group-item list-group-item-action py-3 px-3 border-bottom-0 noti-list ${o.isRead==="N"?"bg-red-50":""}`,onClick:()=>n(o.notiUrl),style:{cursor:"pointer"},children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-1",children:[e.jsx("div",{className:"text-truncate small",style:{maxWidth:"85%"},children:e.jsxs("span",{className:"text-muted",children:["From. ",o.senderId]})}),e.jsx("small",{className:"text-muted",style:{fontSize:"0.7rem"},children:N(o.notiRegdate)})]}),e.jsx("div",{className:`mb-2 small ${o.isRead==="N"?"fw-bold text-dark":"text-secondary"}`,children:o.notiMessage}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{className:"btn btn-xs btn-outline-secondary",onClick:t=>T(t,o.notiNo),title:o.isRead==="Y"?"ì•ˆì½ìŒ ì²˜ë¦¬":"ì½ìŒ ì²˜ë¦¬",children:e.jsx("i",{className:`bi ${o.isRead==="Y"?"bi-envelope":"bi-envelope-open"}`})}),e.jsx("button",{className:"btn btn-xs btn-outline-danger",onClick:t=>f(t,o.notiNo),title:"ì‚­ì œ",children:e.jsx("i",{className:"bi bi-trash"})})]})]},o.notiNo))})}),e.jsx("div",{className:"flex-shrink-0 p-2 border-top text-end",style:{minHeight:"2rem"}})]})},_=Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:x=>{x.addEventListener("mouseenter",Swal.stopTimer),x.addEventListener("mouseleave",Swal.resumeTimer)}}),Y=({onProjectSelect:x,refreshTrigger:d})=>{const[y,k]=r.useState([]),[u,v]=r.useState(!0);r.useEffect(()=>{S()},[]),r.useEffect(()=>{d>0&&(console.log("â™»ï¸ ì†Œì¼“ ì‹ í˜¸ ê°ì§€: ëª©ë¡ ìƒˆë¡œê³ ì¹¨"),S())},[d]);const S=async()=>{try{const n=await R.get("/tudio/dashboard/bookmark/list");k(n.data)}catch(n){console.error("ë¶ë§ˆí¬ ë¡œë“œ ì‹¤íŒ¨",n)}finally{v(!1)}},g=async(n,h)=>{n.stopPropagation();const m=[...y];k(m.filter(j=>j.projectNo!==h));try{const j=await R.post("/tudio/project/bookmark",{projectNo:h});if(j.data&&j.data.status==="SUCCESS")_.fire({icon:"success",title:"ë¶ë§ˆí¬ê°€ í•´ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),console.log("ë¶ë§ˆí¬ í•´ì œ ì™„ë£Œ");else throw new Error("Server returned status: "+(j.data?j.data.status:"Unknown"))}catch(j){console.error("ë¶ë§ˆí¬ ë³€ê²½ ì‹¤íŒ¨",j),k(m),_.fire({icon:"error",title:"ë¶ë§ˆí¬ ë³€ê²½ ì‹¤íŒ¨"})}},a=n=>{if(!n)return"-";const h=new Date(n),m=String(h.getFullYear()).slice(-2),j=String(h.getMonth()+1).padStart(2,"0"),o=String(h.getDate()).padStart(2,"0");return`${m}.${j}.${o}`},N=(n,h)=>{const m=Number(n)||0,j=Number(h)||0;return m===0?0:Math.round(j/m*100)},T=(n,h)=>{if(!n||!h)return 0;const m=new Date(n).getTime(),j=new Date(h).getTime(),o=new Date().getTime(),t=j-m,i=o-m;if(t<=0)return 100;if(i<0)return 0;const c=Math.round(i/t*100);return c>100?100:c},f=n=>{const h="badge rounded-pill ms-1 px-2 py-1",m={fontSize:"0.6rem",padding:"0.25em 0.6em"};return n===1?e.jsx("span",{className:`${h} bg-success`,style:m,children:"ì™„ë£Œ"}):n===2?e.jsx("span",{className:`${h} bg-secondary`,style:m,children:"ì¤‘ë‹¨"}):e.jsx("span",{className:`${h} bg-primary`,style:m,children:"ì§„í–‰"})};return u?e.jsx("div",{className:"text-center py-4",children:e.jsx("span",{className:"spinner-border spinner-border-sm text-primary"})}):e.jsxs("div",{className:"widget-content d-flex flex-column h-100 overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 p-3 border-bottom d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"fw-bold m-0 text-dark",children:[e.jsx("i",{className:"bi bi-bookmark-star-fill text-info me-2"}),"ë¶ë§ˆí¬ í”„ë¡œì íŠ¸"]}),e.jsx("span",{className:"badge bg-light text-secondary border",children:y.length})]}),e.jsx("div",{className:"flex-grow-1 overflow-auto custom-scrollbar",style:{minHeight:0},children:u?e.jsxs("div",{className:"d-flex justify-content-center align-items-center h-100 text-muted",children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2"})," ë¡œë”©ì¤‘..."]}):y.length===0?e.jsxs("div",{className:"text-center text-muted py-5 small",children:[e.jsx("i",{className:"bi bi-star d-block fs-3 mb-2 opacity-50"}),"ë¶ë§ˆí¬í•œ í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤."]}):e.jsx("ul",{className:"list-group list-group-flush gap-1",children:y.map(n=>{const h=N(n.myTotalTaskCount,n.myDoneTaskCount),m=T(n.projectStartdate,n.projectEnddate);return e.jsxs("li",{className:"list-group-item list-group-item-action px-3 d-flex cursor-pointer",onClick:()=>x({projectNo:n.projectNo,projectName:n.projectName}),style:{cursor:"pointer"},children:[e.jsxs("div",{className:"d-flex align-items-center overflow-hidden me-2",style:{width:"35%",minWidth:0},children:[e.jsx("button",{className:"btn btn-link p-0 text-warning border-0 flex-shrink-0 me-2",style:{lineHeight:0},onClick:j=>g(j,n.projectNo),title:"ë¶ë§ˆí¬ í•´ì œ",children:e.jsx("i",{className:"bi bi-star-fill fs-6"})}),e.jsxs("div",{className:"d-flex overflow-hidden align-items-center",children:[e.jsx("div",{className:"fw-bold text-dark text-truncate",title:n.projectName,style:{fontSize:"0.9rem"},children:n.projectName}),f(n.projectStatus)]})]}),e.jsxs("div",{className:"d-flex flex-column justify-content-center border-start ps-3",style:{width:"65%"},children:[e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",style:{fontSize:"0.75rem"},children:[e.jsx("span",{className:"text-primary fw-bold",children:"ë‚´ ì—…ë¬´ ì§„í–‰í˜„í™©"}),e.jsxs("span",{className:"fw-bold small",children:[h,"% ",e.jsxs("span",{className:"text-muted fw-light",children:["(",n.myDoneTaskCount,"/",n.myTotalTaskCount,")"]})]})]}),e.jsx("div",{className:"progress",style:{height:"6px",backgroundColor:"#fff"},children:e.jsx("div",{className:"progress-bar bg-primary",style:{width:`${h}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",style:{fontSize:"0.75rem"},children:[e.jsx("span",{className:"text-primary fw-bold",children:"í”„ë¡œì íŠ¸ ì§„ì²™ë„"}),e.jsxs("span",{className:"text-dark small",children:[m,"%"]})]}),e.jsx("div",{className:"progress mb-1",style:{height:"4px",backgroundColor:"#fff"},children:e.jsx("div",{className:"progress-bar bg-secondary opacity-50",style:{width:`${m}%`}})}),e.jsxs("div",{className:"text-muted text-end",style:{fontSize:"0.65rem",whiteSpace:"nowrap"},children:[a(n.projectStartdate)," ~ ",a(n.projectEnddate)]})]})]})]},n.projectNo)})})}),e.jsx("div",{className:"flex-shrink-0 py-2 px-3 border-top text-end bg-light rounded-bottom",children:e.jsxs("span",{className:"text-muted small",style:{fontSize:"0.75rem"},children:[e.jsx("i",{className:"bi bi-info-circle me-1"}),"ë¶ë§ˆí¬í•œ í”„ë¡œì íŠ¸ë¥¼ ì„ íƒí•˜ì—¬ ",e.jsx("span",{className:"fw-bold text-primary",children:"To Do List"}),"ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."]})})]})},W=D.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1e3,timerProgressBar:!0,didOpen:x=>{x.addEventListener("mouseenter",D.stopTimer),x.addEventListener("mouseleave",D.resumeTimer)}}),J=({projectNo:x,projectName:d,onClearProject:y,refreshTrigger:k})=>{const[u,v]=r.useState([]),[S,g]=r.useState(!1),[a,N]=r.useState(!1),[T,f]=r.useState(""),[n,h]=r.useState(null),[m,j]=r.useState(""),[o,t]=r.useState("ALL"),i=r.useRef(null),c=r.useRef(null),C=async()=>{try{const l=await R.get("/tudio/dashboard/todo/list",{params:{projectNo:x||0}});v(l.data||[])}catch(l){console.error("íˆ¬ë‘ ë¡œë“œ ì‹¤íŒ¨",l)}finally{g(!1)}};r.useEffect(()=>{C(),N(!1),h(null),t("ALL")},[x]),r.useEffect(()=>{k>0&&(console.log("â™»ï¸ [TodoWidget] ê°±ì‹  ì‹ í˜¸ ìˆ˜ì‹ "),C())},[k]),r.useEffect(()=>{a&&i.current&&i.current.focus()},[a]),r.useEffect(()=>{n&&c.current&&c.current.focus()},[n]);const O=async()=>{if(!T.trim()){W.fire({icon:"warning",title:"ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."});return}try{(await R.post("/tudio/dashboard/todo/insert",{todoContent:T,projectNo:x||0})).data==="OK"?(W.fire({icon:"success",title:"í•  ì¼ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤."}),f(""),C(),i.current&&i.current.focus()):D.fire("ì‹¤íŒ¨","ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}catch(l){console.error("ë“±ë¡ ì—ëŸ¬",l),D.fire("ì—ëŸ¬","ì„œë²„ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.","error")}},M=async l=>{const w=l.todoStatus==="Y"?"N":"Y",L=[...u];v(u.map(A=>A.todoNo===l.todoNo?{...A,todoStatus:w}:A));try{const A=await R.post("/tudio/dashboard/todo/updateStatus",{todoNo:l.todoNo,todoStatus:w});if(console.log(A.data),A.status===200&&A.data==="OK")console.log("âœ… ì„±ê³µ");else throw new Error("DB ì—…ë°ì´íŠ¸ ì‹¤íŒ¨ (0ê±´ ìˆ˜ì •ë¨)")}catch(A){v(L),console.error("ìƒíƒœ ë³€ê²½ ì‹¤íŒ¨",A),D.fire("ì˜¤ë¥˜","ìƒíƒœ ë³€ê²½ ì‹¤íŒ¨","error")}},$=async l=>{if((await D.fire({title:"ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",text:"ì‚­ì œëœ ë°ì´í„°ëŠ” ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"ë„¤, ì‚­ì œí•©ë‹ˆë‹¤",cancelButtonText:"ì·¨ì†Œ",customClass:{popup:"small-swal"}})).isConfirmed)try{(await R.post("/tudio/dashboard/todo/delete",{todoNo:l})).data==="OK"?(W.fire({icon:"success",title:"ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."}),v(u.filter(A=>A.todoNo!==l))):D.fire("ì˜¤ë¥˜","ì‚­ì œ ì‹¤íŒ¨","error")}catch{D.fire("ì˜¤ë¥˜","ì„œë²„ í†µì‹  ì‹¤íŒ¨","error")}},P=l=>{h(l.todoNo),j(l.todoContent)},s=async()=>{if(!m.trim()){D.fire({icon:"warning",title:"ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."});return}try{(await R.post("/tudio/dashboard/todo/updateContent",{todoNo:n,todoContent:m})).data==="OK"?(W.fire({icon:"success",title:"ìˆ˜ì • ì™„ë£Œ"}),v(u.map(w=>w.todoNo===n?{...w,todoContent:m}:w)),h(null)):D.fire("ì‹¤íŒ¨","ìˆ˜ì • ì‹¤íŒ¨","error")}catch(l){console.error("ìˆ˜ì • ì‹¤íŒ¨",l)}},p=r.useMemo(()=>{const l=u.length,w=u.filter(A=>A.todoStatus==="Y").length,L=l-w;return{total:l,done:w,active:L}},[u]),E=r.useMemo(()=>{let l=u;return o==="ACTIVE"?l=u.filter(w=>w.todoStatus==="N"):o==="DONE"&&(l=u.filter(w=>w.todoStatus==="Y")),l},[u,o]),b=()=>S?"ë¡œë”©ì¤‘...":u.length===0?x>0?"ì´ í”„ë¡œì íŠ¸ì— í•  ì¼ì´ ì—†ìŠµë‹ˆë‹¤.":"ë“±ë¡ëœ í•  ì¼ì´ ì—†ìŠµë‹ˆë‹¤.":o==="ACTIVE"?"ì§„í–‰ ì¤‘ì¸ í•  ì¼ì´ ì—†ìŠµë‹ˆë‹¤.":o==="DONE"?"ì™„ë£Œëœ í•  ì¼ì´ ì—†ìŠµë‹ˆë‹¤.":"í•  ì¼ì´ ì—†ìŠµë‹ˆë‹¤.";return e.jsxs("div",{className:"widget-content zen-folder-widget bg-white d-flex flex-column rounded shadow-sm position-relative",style:{height:"100%",width:"100%",overflow:"hidden"},children:[e.jsx("style",{children:`
                .todo-tab { cursor: pointer; transition: all 0.2s; border-top: 2px solid transparent; }
                .todo-tab:hover { background-color: #f8f9fa; }
                .todo-tab.active { background-color: #EFF6FF; color: #3B82F6; font-weight: bold;}
                .todo-tab .badge { transition: all 0.2s; }
                .todo-tab.active .badge { background-color: #3B82F6 !important; color: white !important; opacity: 1 !important; }
            `}),e.jsxs("div",{className:"folder-shape-layer",style:{position:"absolute",inset:0,zIndex:0},children:[e.jsx("div",{className:"folder-tab-todo"}),e.jsx("div",{className:"folder-body-bg"})]}),e.jsxs("div",{className:"folder-content-layer d-flex flex-column h-100 position-relative",style:{zIndex:1,paddingLeft:"6px"},children:[e.jsx("div",{className:"widget-header-wrapper flex-shrink-0",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center widget-header-custom",children:[e.jsxs("h6",{className:"font-weight-bold m-0 text-gray-800",style:{padding:"14px 20px"},children:[e.jsx("i",{className:"bi bi-check2-square text-primary me-2"}),"To Do List"]}),e.jsx("button",{className:"btn btn-sm btn-white bg-white shadow-sm border rounded-circle d-flex align-items-center justify-content-center",onClick:()=>N(!a),title:"í•  ì¼ ì¶”ê°€",style:{width:"32px",height:"32px"},children:e.jsx("i",{className:`bi ${a?"bi-x-lg text-danger":"bi-plus-lg text-primary fw-bold"}`})})]})}),x>0&&e.jsxs("div",{className:"flex-shrink-0 px-3 py-2 border-bottom d-flex justify-content-between align-items-center bg-white bg-opacity-75",children:[e.jsxs("span",{className:"small fw-bold text-primary text-truncate",children:[e.jsx("i",{className:"bi bi-folder-fill me-1"}),d]}),e.jsx("button",{type:"button",className:"btn btn-xs btn-link text-secondary p-0 ms-2",onClick:y,title:"ì „ì²´ ëª©ë¡ ë³´ê¸°",children:e.jsx("i",{className:"bi bi-x-circle-fill"})})]}),a&&e.jsx("div",{className:"flex-shrink-0 px-3 mb-2 pt-2 animate-fade-in",children:e.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center bg-light border rounded p-2",children:[e.jsx("div",{className:"d-flex align-items-center w-100 me-2",children:e.jsx("input",{type:"text",ref:i,className:"form-control form-control-sm",placeholder:"í•  ì¼ ì¶”ê°€",value:T,onChange:l=>f(l.target.value),onKeyDown:l=>{l.key==="Enter"&&O(),l.key==="Escape"&&N(!1)}})}),e.jsx("button",{className:"btn btn-sm btn-primary",style:{minWidth:"50px"},onClick:O,children:"ì¶”ê°€"})]})}),e.jsx("div",{className:"flex-grow-1 overflow-auto custom-scrollbar px-0",id:`todo-list-area-${x}`,style:{minHeight:0},children:E.length===0?e.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center h-100 text-muted small pb-4",children:[e.jsx("i",{className:`bi ${o==="ACTIVE"?"bi-emoji-smile":"bi-clipboard-check"} fs-4 mb-2 opacity-50`}),e.jsx("span",{className:"mt-2",children:b()})]}):e.jsx("ul",{className:"list-group list-group-flush",children:E.map(l=>e.jsxs("li",{className:"list-group-item px-3 py-2 border-bottom-0 d-flex align-items-center group-hover-target",onMouseEnter:w=>w.currentTarget.classList.add("bg-light"),onMouseLeave:w=>w.currentTarget.classList.remove("bg-light"),children:[e.jsxs("div",{className:"form-check m-0 d-flex align-items-center flex-grow-1 text-truncate",style:{maxWidth:"80%"},children:[e.jsx("input",{className:"form-check-input cursor-pointer mt-0",type:"checkbox",id:`todoCheck${l.todoNo}`,checked:l.todoStatus==="Y",onChange:()=>M(l)}),n===l.todoNo?e.jsxs("div",{className:"d-flex ms-2 w-100 align-items-center",children:[e.jsx("input",{type:"text",ref:c,className:"form-control form-control-sm me-2",value:m,onChange:w=>j(w.target.value),onKeyDown:w=>{w.key==="Enter"&&s(),w.key==="Escape"&&h(null)}}),e.jsx("button",{className:"btn btn-sm btn-success text-nowrap",style:{minWidth:"50px"},onClick:s,children:"ì €ì¥"}),e.jsx("button",{className:"btn btn-sm btn-secondary text-nowrap",onClick:()=>h(null),children:"ì·¨ì†Œ"})]}):e.jsx("label",{className:`form-check-label ms-2 cursor-pointer text-truncate ${l.todoStatus==="Y"?"text-decoration-line-through text-muted":""}`,htmlFor:`todoCheck${l.todoNo}`,onDoubleClick:()=>P(l),style:{fontSize:"0.9rem",width:"100%"},title:l.todoContent,children:l.todoContent})]}),n!==l.todoNo&&e.jsxs("div",{className:"btn-group btn-group-sm opacity-50 group-hover-visible transition-opacity ms-auto",children:[e.jsx("button",{type:"button",className:"btn btn-link text-secondary p-0 me-2",onClick:()=>P(l),title:"ìˆ˜ì •",children:e.jsx("i",{className:"bi bi-pencil-square"})}),e.jsx("button",{type:"button",className:"btn btn-link text-danger p-0",onClick:()=>$(l.todoNo),title:"ì‚­ì œ",children:e.jsx("i",{className:"bi bi-trash"})})]})]},l.todoNo))})}),e.jsxs("div",{className:"flex-shrink-0 px-3 py-2 gap-2 d-flex border-top text-end",children:[e.jsxs("div",{className:`flex-fill d-flex align-items-center justify-content-center small todo-tab ${o==="ALL"?"active":"text-muted"}`,onClick:()=>t("ALL"),children:[e.jsx("span",{children:"ì „ì²´"}),e.jsx("span",{className:"badge bg-light border text-primary rounded-pill ms-1",children:p.total})]}),e.jsx("div",{className:"vr my-2 opacity-25"}),e.jsxs("div",{className:`flex-fill d-flex align-items-center justify-content-center small todo-tab ${o==="ACTIVE"?"active":"text-muted"}`,onClick:()=>t("ACTIVE"),children:[e.jsx("span",{children:"ì§„í–‰"}),e.jsx("span",{className:"badge bg-light border text-primary rounded-pill ms-1",children:p.active})]}),e.jsx("div",{className:"vr my-2 opacity-25"}),e.jsxs("div",{className:`flex-fill d-flex align-items-center justify-content-center small todo-tab ${o==="DONE"?"active":"text-muted"}`,onClick:()=>t("DONE"),children:[e.jsx("span",{children:"ì™„ë£Œ"}),e.jsx("span",{className:"badge bg-light border text-primary rounded-pill ms-1",children:p.done})]})]})]})]})},G=()=>{const[x,d]=r.useState([]);return r.useEffect(()=>{R.get("/tudio/dashboard/survey/pending").then(y=>{Array.isArray(y.data)?d(y.data):d([])}).catch(y=>{console.error("ì„¤ë¬¸ ë¡œë“œ ì‹¤íŒ¨",y),d([])})},[]),!x||x.length===0?null:e.jsxs("div",{className:"alert alert-primary d-flex align-items-center justify-content-between mb-4 shadow-sm border-0",role:"alert",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-clipboard-check-fill fs-4 me-3 text-primary"}),e.jsxs("div",{children:[e.jsxs("strong",{children:["ë¯¸ì°¸ì—¬ ì„¤ë¬¸ì´ ",x.length,"ê±´ ìˆìŠµë‹ˆë‹¤!"]}),e.jsx("div",{className:"small text-muted",children:"ì†Œì¤‘í•œ ì˜ê²¬ì„ ë‚¨ê²¨ì£¼ì„¸ìš”."})]})]}),e.jsx("div",{className:"d-flex gap-2",children:(x||[]).slice(0,2).map(y=>e.jsxs("a",{href:`/tudio/survey/detail/${y.surveyNo}`,className:"btn btn-sm btn-light text-primary fw-bold border",children:[y.surveyTitle," ",e.jsx("i",{className:"bi bi-arrow-right ms-1"})]},y.surveyNo))})]})},V=({refreshTrigger:x})=>{const[d,y]=r.useState([]),[k,u]=r.useState(!0),v=()=>{R.get("/tudio/dashboard/notice").then(a=>{y(a.data||[])}).catch(a=>console.error("ê³µì§€ì‚¬í•­ ë¡œë“œ ì‹¤íŒ¨",a)).finally(()=>u(!1))};r.useEffect(()=>{v()},[]),r.useEffect(()=>{x>0&&(console.log("â™»ï¸ [ê³µì§€ì‚¬í•­] ê°±ì‹  ì‹ í˜¸ ìˆ˜ì‹  -> ì¬ì¡°íšŒ"),v())},[x]);const S=a=>{window.location.href=`/tudio/notice/detail?noticeNo=${a}`},g=a=>{if(!a)return"-";const N=new Date(a),T=String(N.getFullYear()).slice(-2),f=String(N.getMonth()+1).padStart(2,"0"),n=String(N.getDate()).padStart(2,"0");return`${T}.${f}.${n}`};return k?e.jsx("div",{className:"text-center py-4",children:e.jsx("span",{className:"spinner-border spinner-border-sm text-warning"})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"widget-content d-flex flex-column h-100 overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 p-3 border-bottom d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"fw-bold m-0",children:[e.jsx("i",{className:"bi bi-megaphone-fill me-2 text-warning"}),"ì‹œìŠ¤í…œ ê³µì§€ì‚¬í•­"]}),e.jsx("a",{href:"/tudio/notice/list",className:"text-muted small text-decoration-none",title:"ë”ë³´ê¸°",children:e.jsx("i",{className:"bi bi-plus-lg"})})]}),e.jsx("div",{className:"flex-grow-1 overflow-y-auto custom-scrollbar",style:{minHeight:0},children:d.length===0?e.jsxs("div",{className:"d-flex align-items-center justify-content-center h-100 text-muted small",children:[e.jsx("i",{className:"bi bi-exclamation-circle fs-4 mx-2 opacity-50"}),e.jsx("span",{children:"ë“±ë¡ëœ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤."})]}):e.jsx("ul",{className:"list-group list-group-flush",children:d.map(a=>e.jsxs("li",{className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center px-3 py-3",children:[e.jsxs("div",{className:"d-flex align-items-center overflow-hidden me-2",style:{flex:1},children:[a.noticeFixStatus==="Y"&&e.jsx("i",{className:"bi bi-pin-angle-fill text-danger me-2 small flex-shrink-0",title:"ì¤‘ìš” ê³µì§€"}),e.jsx("span",{className:"notice-title text-dark small fw-bold text-truncate cursor-pointer",onClick:()=>S(a.noticeNo),style:{cursor:"pointer"},title:a.noticeTitle,children:a.noticeTitle}),new Date(a.noticeRegdate).toDateString()===new Date().toDateString()&&e.jsx("span",{className:"badge bg-danger rounded-pill ms-2",style:{fontSize:"0.5rem",padding:"0.2em 0.4em"},children:"New"})]}),e.jsxs("div",{className:"d-flex align-items-center flex-shrink-0",style:{fontSize:"0.75rem"},children:[e.jsxs("span",{className:"text-secondary me-2 fw-bold",children:[e.jsx("i",{className:"bi bi-person me-1 text-muted"}),a.writer||"ê´€ë¦¬ì"]}),e.jsx("span",{className:"text-muted small bg-light border px-2 py-1 rounded",children:g(a.noticeRegdate)})]})]},a.noticeNo))})}),e.jsx("div",{className:"flex-shrink-0 p-2 border-top text-end",style:{minHeight:"2rem"}})]})})},H=({refreshTrigger:x})=>{const[d,y]=r.useState([]),[k,u]=r.useState(!0),v=()=>{R.get("/tudio/dashboard/deadlineWork").then(a=>{console.log("ë§ˆê°ì„ë°• ë°ì´í„° í™•ì¸:",a.data),y(a.data||[])}).catch(a=>console.error("ë§ˆê°ì„ë°• ë¡œë“œ ì‹¤íŒ¨",a)).finally(()=>u(!1))};if(r.useEffect(()=>{v()},[]),r.useEffect(()=>{x>0&&(console.log("â™»ï¸ [ë§ˆê°ì„ë°•] ê°±ì‹  ì‹ í˜¸ ìˆ˜ì‹  -> ì¬ì¡°íšŒ"),v())},[x]),k)return e.jsx("div",{className:"text-center py-4",children:e.jsx("span",{className:"spinner-border spinner-border-sm text-danger"})});const S=a=>{const N=a<=0,T=N?"bg-danger":"bg-warning",f=N?"text-white":"text-dark";let n="";return a<0?n=`D+${Math.abs(a)}`:a===0?n="D-Day":n=`D-${a}`,e.jsx("div",{className:`${T} ${f} rounded d-flex align-items-center justify-content-center fw-bold shadow-sm`,style:{width:"50px",height:"50px",fontSize:"1rem",flexShrink:0},children:n})},g=a=>{window.location.href=`/tudio/project/detail?projectNo=${a}`};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"widget-content d-flex flex-column h-100 overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 p-3 border-bottom d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"fw-bold m-0 text-dark",children:[e.jsx("i",{className:"bi bi-stopwatch-fill me-2"}),"ë§ˆê° ì„ë°• ì—…ë¬´"]}),e.jsxs("span",{className:"badge bg-danger rounded-pill",children:[d.length,"ê±´"]})]}),e.jsx("div",{className:"flex-grow-1 overflow-auto custom-scrollbar p-0",style:{minHeight:0},children:k?e.jsx("div",{className:"d-flex justify-content-center align-items-center h-100",children:e.jsx("div",{className:"spinner-border spinner-border-sm text-danger",role:"status"})}):d.length===0?e.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center h-100 text-muted small py-5",children:[e.jsx("i",{className:"bi bi-check-circle fs-4 mb-2 text-success"}),e.jsx("span",{className:"small text-secondary mt-1",children:"ì¼ì£¼ì¼ ë‚´ ë§ˆê° ì˜ˆì •ì¸ ì—…ë¬´ê°€ ì—†ìŠµë‹ˆë‹¤."})]}):e.jsx("div",{className:"d-flex flex-column px-2 py-2",style:{gap:"2"},children:d.map((a,N)=>{const T=a.taskDday<=0;return e.jsxs("div",{className:"deadline-card-item bg-light rounded p-3 d-flex align-items-center shadow-sm cursor-pointer",style:{marginBottom:"0.5rem"},onClick:()=>g(a.projectNo),children:[e.jsx("div",{className:"me-3",children:S(a.taskDday)}),e.jsxs("div",{className:"flex-grow-1 overflow-hidden",children:[e.jsxs("div",{className:"d-flex justify-content-between small text-muted mb-1",children:[e.jsxs("span",{className:"badge bg-light border text-truncate d-flex align-items-center text-primary fw-bold",children:[e.jsx("i",{className:"bi bi-folder-fill me-1 opacity-75",style:{fontSize:"0.6rem"}})," ",a.projectName]}),e.jsxs("span",{className:`fw-bold ${T?"text-danger":"text-warning"}`,style:{fontSize:"0.7rem"},children:["~ ",a.taskEnddate]})]}),e.jsx("div",{className:"fw-bold text-dark text-truncate mt-1 mb-1",style:{fontSize:"0.95rem"},title:a.taskTitle,children:a.taskTitle}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"progress flex-grow-1",style:{height:"6px",backgroundColor:"#edf2f7",borderRadius:"3px"},children:e.jsx("div",{className:`progress-bar ${T?"bg-danger":"bg-warning"}`,role:"progressbar",style:{width:`${a.taskRate}%`}})}),e.jsxs("small",{className:"ms-2 fw-bold text-muted",style:{fontSize:"0.75rem",width:"30px",textAlign:"right"},children:[a.taskRate,"%"]})]})]})]},N)})})}),e.jsx("div",{className:"p-2 border-top bg-light text-center small text-muted",children:d.length>0?e.jsxs("span",{children:[e.jsx("i",{className:"bi bi-exclamation-triangle-fill text-warning me-1"}),"ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ ì—…ë¬´ë¶€í„° ì²˜ë¦¬í•˜ì„¸ìš”."]}):e.jsxs("span",{children:[e.jsx("i",{className:"bi bi-emoji-smile text-primary me-1"}),"ëª¨ë“  ì—…ë¬´ê°€ ì•ˆì •ì ì…ë‹ˆë‹¤."]})})]})})},Z=()=>{const[x,d]=r.useState([]),[y,k]=r.useState([]),[u,v]=r.useState(!1),S=r.useRef(null),[g,a]=r.useState({no:0,name:""}),[N,T]=r.useState({PERSONAL_WORK:0,DRAFT:0,ALARM:0,PROJECT_BOOKMARK:0,TODO:0,NOTICE:0,PROJECT_SUMMARY:0}),f=document.body.dataset.contextPath||"",n=document.body.dataset.loginNo?parseInt(document.body.dataset.loginNo,10):0,h=s=>{!s||typeof s!="object"||a({no:s.projectNo,name:s.projectName})},m=()=>{a({no:0,name:""})};r.useEffect(()=>{const s=document.getElementById("mainContent");if(s)return u?s.classList.add("dashboard-edit-mode"):s.classList.remove("dashboard-edit-mode"),()=>s.classList.remove("dashboard-edit-mode")},[u]),r.useEffect(()=>{(async()=>{try{const p=await R.get("/tudio/dashboard/layout"),E=Array.isArray(p.data)?p.data:[];d(E.filter(b=>b.widgetStatus==="Y")),k(E.filter(b=>b.widgetStatus==="N"))}catch(p){console.error("Layout fetch error",p)}})()},[]),r.useEffect(()=>{if(x.length===0)return;const s=document.querySelector(".grid-stack");if(!s||S.current)return;console.log("Grid Container Width:",s.offsetWidth);const p=I.init({column:12,cellHeight:100,margin:10,disableOneColumnMode:!0,animate:!0,float:!1,staticGrid:!u,removable:!1,children:!1,minRow:5,resizable:{handles:"n, e, s, w, nw, sw, se"}},s);return S.current=p,()=>{p&&(p.destroy(!1),S.current=null)}},[x]),r.useEffect(()=>{S.current&&(S.current.setStatic(!u),u&&setTimeout(()=>{window.dispatchEvent(new Event("resize")),console.log("Triggered window resize for GridStack")},320))},[u]);const j=(s,p)=>{s.dataTransfer.setData("widget-data",JSON.stringify(p)),s.dataTransfer.effectAllowed="copy",document.body.style.cursor="grabbing"},o=()=>{document.body.style.cursor="auto",document.querySelector(".grid-stack")?.classList.remove("drag-over")},t=s=>{s.preventDefault(),s.stopPropagation(),s.dataTransfer.dropEffect="copy",s.currentTarget.classList.add("drag-over")},i=s=>{s.preventDefault(),s.currentTarget.classList.remove("drag-over"),document.body.style.cursor="auto";const p=s.dataTransfer.getData("widget-data");if(!p)return;const E=JSON.parse(p);k(b=>b.filter(l=>String(l.widgetNo)!==String(E.widgetNo))),d(b=>b.some(l=>String(l.widgetNo)===String(E.widgetNo))?b:[...b,{...E,x:0,y:0,widgetStatus:"Y",autoPosition:!0}])},c=r.useCallback(s=>{v(s)},[]),C=s=>{d(p=>{const E=p.find(b=>b.widgetNo==s);return E?(k(b=>[...b,{...E,x:0,y:0,widgetStatus:"N"}]),p.filter(b=>b.widgetNo!=s)):p})},O=async()=>{if(!S.current)return;const p=S.current.save(!1).map(b=>({widgetNo:b.id,x:b.x,y:b.y,width:b.w,height:b.h,widgetStatus:"Y"})),E=y.map(b=>({widgetNo:b.widgetNo,x:0,y:0,width:b.width,height:b.height,widgetStatus:"N"}));try{await R.post("/tudio/dashboard/layout/save",[...p,...E]),D.fire({icon:"success",title:"ì €ì¥ ì™„ë£Œ",text:"ë ˆì´ì•„ì›ƒì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.",timer:1500,showConfirmButton:!1}),c(!1)}catch{D.fire("ì˜¤ë¥˜","ì €ì¥ ì‹¤íŒ¨","error")}};r.useEffect(()=>{if(!n)return;const s=new U(`${f}/ws-stomp`),p=z.over(s);return p.debug=null,p.connect({},()=>{console.log(`âœ… WebSocket Connected (Member: ${n})`),p.subscribe(`/sub/dashboard/${n}`,E=>{const l=JSON.parse(E.body).type;l&&N.hasOwnProperty(l)&&(console.log(`â™»ï¸ [${l}] ìœ„ì ¯ ê°±ì‹  ì‹ í˜¸ ìˆ˜ì‹ `),T(w=>({...w,[l]:w[l]+1})))})}),()=>{p&&p.disconnect()}},[f,n]);const M=s=>P[s]?.title||"ìœ„ì ¯",$=s=>P[s]?.icon||"bi-grid",P=r.useMemo(()=>({PERSONAL_WORK:{component:e.jsx(B,{refreshTrigger:N.PERSONAL_WORK}),title:"ê°œì¸ ì—…ë¬´",icon:"bi-calendar-week"},DRAFT:{component:e.jsx(F,{refreshTrigger:N.DRAFT}),title:"ì „ìê²°ì¬",icon:"bi-file-earmark-text"},ALARM:{component:e.jsx(K,{refreshTrigger:N.ALARM}),title:"ë¯¸í™•ì¸ ì•Œë¦¼",icon:"bi-bell-fill"},PROJECT_BOOKMARK:{component:e.jsx(Y,{onProjectSelect:h,refreshTrigger:N.PROJECT_BOOKMARK}),title:"ë¶ë§ˆí¬ í”„ë¡œì íŠ¸",icon:"bi-bookmark-star-fill"},TODO:{component:e.jsx(J,{projectNo:g.no,projectName:g.name,onClearProject:m,refreshTrigger:N.TODO}),title:"To Do List",icon:"bi-check2-square"},NOTICE:{component:e.jsx(V,{refreshTrigger:N.NOTICE}),title:"ì‹œìŠ¤í…œ ê³µì§€ì‚¬í•­",icon:"bi-megaphone-fill"},PROJECT_SUMMARY:{component:e.jsx(H,{refreshTrigger:N.PROJECT_SUMMARY}),title:"ë§ˆê° ì„ë°• ì—…ë¬´",icon:"bi-stopwatch"}}),[g,N]);return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("svg",{width:"0",height:"0",style:{position:"absolute",visibility:"hidden",pointerEvents:"none"},children:e.jsx("defs",{children:e.jsxs("filter",{id:"filter-svg",children:[e.jsx("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"5",result:"blur"}),e.jsx("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 19 -9",result:"goo"}),e.jsx("feComposite",{in:"SourceGraphic",in2:"goo",operator:"atop"})]})})}),e.jsxs("div",{className:"dashboard-content-wrapper",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center px-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"fw-bold text-primary-dark mb-2",style:{color:"#00407F"},children:"ëŒ€ì‹œë³´ë“œ"}),e.jsx("p",{className:"text-muted small m-0",children:"Tudioì™€ í•¨ê»˜ í™œê¸°ì°¨ê²Œ ì—…ë¬´ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš” !"})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("div",{className:"bg-white rounded-pill px-3 py-2 d-flex align-items-center border shadow-sm gap-3",children:e.jsxs("div",{className:"form-check form-switch m-0",children:[e.jsx("input",{className:"form-check-input cursor-pointer",type:"checkbox",id:"editModeSwitch",checked:u,onChange:s=>c(s.target.checked)}),e.jsx("label",{className:"form-check-label small fw-bold ms-2 cursor-pointer",htmlFor:"editModeSwitch",children:"ìœ„ì ¯ í¸ì§‘"})]})}),u&&e.jsxs("button",{className:"btn btn-sm btn-primary rounded-pill px-3 py-2 fw-bold shadow-sm",onClick:O,children:[e.jsx("i",{className:"bi bi-check-lg me-1"})," ì €ì¥"]})]})]}),e.jsx("div",{className:"px-4",children:e.jsx(G,{})}),e.jsx("div",{className:"main-content-wrapper px-2",children:e.jsx("div",{className:"grid-stack",style:{minHeight:"600px"},onDragOver:u?t:void 0,onDrop:u?i:void 0,children:x.map(s=>e.jsx("div",{className:"grid-stack-item","gs-id":s.widgetNo,"gs-x":s.x,"gs-y":s.y,"gs-w":s.width,"gs-h":s.height,"gs-auto-position":s.autoPosition?"true":void 0,"data-type":s.widgetType,children:e.jsxs("div",{className:"grid-stack-item-content",children:[u&&e.jsx("div",{className:"btn-close-widget",onClick:()=>C(s.widgetNo),children:e.jsx("i",{className:"bi bi-x-lg"})}),P[s.widgetType]?.component]})},s.widgetNo))})})]}),e.jsxs("div",{className:`widget-drawer ${u?"open":""}`,children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4 p-3",children:[e.jsxs("h5",{className:"fw-bold m-0",children:[e.jsx("i",{className:"bi bi-box-seam me-2"})," ìœ„ì ¯ ë³´ê´€í•¨"]}),e.jsx("button",{className:"btn-close",onClick:()=>c(!1)})]}),e.jsx("div",{id:"sidebar-content",className:"px-3 pb-3 h-100 overflow-auto",children:y.map(s=>e.jsx("div",{className:"sidebar-widget-item mb-3 cursor-grab","gs-id":s.widgetNo,"gs-w":s.width,"gs-h":s.height,"data-type":s.widgetType,draggable:!0,onDragStart:p=>j(p,s),onDragEnd:o,style:{cursor:"grab"},children:e.jsxs("div",{className:"grid-stack-item-content w-100",style:{pointerEvents:"none"},children:[e.jsxs("span",{className:"fw-bold text-dark small",children:[e.jsx("i",{className:`bi ${$(s.widgetType)} me-2 text-primary`}),M(s.widgetType)]}),e.jsx("i",{className:"bi bi-grip-vertical text-muted"})]})},s.widgetNo))})]})]})};export{Z as D};
