<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.ddit.admin.faq.mapper.IFaqMapper">

	<!-- FAQ 목록 조회 -->
	<select id="selectFaqList" resultType="kr.or.ddit.vo.FaqVO">
		SELECT
		    FAQ_NO
		  , ADMIN_NO
		  , FAQ_TITLE
		  , FAQ_CONTENT
		  , FAQ_REGDATE
		  , FAQ_UPDATE
		  , FAQ_ORDER
		  , FAQ_HIT
		  , FILE_GROUP_NO
		  , PUBLIC_STATUS
		FROM
		    FAQ
		ORDER BY
		    FAQ_ORDER
	</select>
	
	<!-- 새 FAQ 등록 -->
	<insert id="insertFaq" parameterType="kr.or.ddit.vo.FaqVO">
		INSERT INTO FAQ (
		      FAQ_NO
		    , ADMIN_NO
		    , FAQ_TITLE
		    , FAQ_CONTENT
		    , FAQ_REGDATE
		    , FAQ_UPDATE
		    , FAQ_ORDER
		    , FAQ_HIT
		    , FILE_GROUP_NO
		    , PUBLIC_STATUS
		) VALUES (
		      SEQ_FAQ.NEXTVAL
		    , #{adminNo}
		    , #{faqTitle}
		    , #{faqContent}
		    , CURRENT_TIMESTAMP
		    , CURRENT_TIMESTAMP
		    , #{faqOrder}
		    , (SELECT MAX(FAQ_ORDER) FROM FAQ) + 1
		    , #{fileGroupNo}
		    , #{publicStatus}
		)
	</insert>
	
	<!-- FAQ 수정 -->
	<update id="updateFaq" parameterType="kr.or.ddit.vo.FaqVO">
		UPDATE FAQ
		SET
		    ADMIN_NO = #{adminNo},
		    FAQ_TITLE = #{faqTitle},
		    FAQ_CONTENT = #{faqContent},
		    FAQ_UPDATE = CURRENT_TIMESTAMP,
		    <if test="fileGroupNo != null and fileGroupNo != ''">
		    	FILE_GROUP_NO = #{fileGroupNo},
		    </if>
		    PUBLIC_STATUS = #{publicStatus}
		WHERE
		    FAQ_NO = #{faqNo}
	</update>

	<!-- FAQ 상태 변경 -->
	<update id="updatePublicStatus" parameterType="kr.or.ddit.vo.FaqVO">
		UPDATE FAQ
		SET
			PUBLIC_STATUS = #{publicStatus}
		WHERE FAQ_NO = #{faqNo}
	</update>

	<!-- FAQ 삭제 -->
	<delete id="deleteFaq" parameterType="int">
		DELETE FROM FAQ
		WHERE
		    FAQ_NO = #{faqNo}
	</delete>

	<!-- FAQ 순서 변경 -->
	<update id="updateFaqOrder" parameterType="list">
		UPDATE FAQ
		SET FAQ_ORDER = CASE FAQ_NO
		<foreach collection="list" item="faq" >
			WHEN #{faq.faqNo} THEN #{faq.faqOrder} 
		</foreach>
		END
	</update>
	
</mapper>