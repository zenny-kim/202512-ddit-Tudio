import{r as a,j as e,a as T,L as $,l as E,W as _,Y as z,Z as B}from"./common.chunk.js";const U=({refreshTrigger:x})=>{const[c,g]=a.useState([]),[v,j]=a.useState(""),[S,y]=a.useState(""),[m,r]=a.useState([]),[N,k]=a.useState(!0),h=l=>{switch(parseInt(l)){case 201:return{text:"ÏöîÏ≤≠",color:"bg-secondary"};case 202:return{text:"ÏßÑÌñâ",color:"bg-success"};case 203:return{text:"ÏôÑÎ£å",color:"bg-primary"};case 204:return{text:"Î≥¥Î•ò",color:"bg-danger"};case 205:return{text:"ÏßÄÏó∞",color:"bg-dark"};default:return{text:"ÎØ∏Ï†ï",color:"bg-secondary"}}},t=()=>{const l=new Date,u=l.getTimezoneOffset()*6e4;return new Date(l-u).toISOString().split("T")[0]},d=a.useCallback(l=>{const u=new Date,C=new Date(u);C.setDate(u.getDate()-u.getDay());const D=[],o=["Ïùº","Ïõî","Ìôî","Ïàò","Î™©","Í∏à","ÌÜ†"];for(let s=0;s<7;s++){const f=new Date(C);f.setDate(C.getDate()+s);const w=f.getFullYear(),b=String(f.getMonth()+1).padStart(2,"0"),O=String(f.getDate()).padStart(2,"0"),A=`${w}-${b}-${O}`,W=l.find(I=>I.WORK_DATE_STR===A),M=W?W.DAILY_COUNT:0;D.push({dateStr:A,dayNum:O,dayName:o[s],count:M})}r(D)},[]),i=async(l=!1)=>{try{const u=await T.get("/tudio/dashboard/personalWork"),{list:C,titleRange:D}=u.data;g(C||[]),j(D),d(C||[]),l&&y(t())}catch(u){console.error("Í∞úÏù∏ÏóÖÎ¨¥ Î°úÎìú Ïã§Ìå®",u)}finally{k(!1)}};a.useEffect(()=>{i(!0)},[]),a.useEffect(()=>{x>0&&(console.log("‚ôªÔ∏è [Í∞úÏù∏ÏóÖÎ¨¥] Í∞±Ïã† Ïã†Ìò∏ ÏàòÏã† -> Ïû¨Ï°∞Ìöå"),i(!1))},[x]);const p=c.filter(l=>l.WORK_DATE_STR===S),R=l=>{window.location.href=`/tudio/project/detail?projectNo=${l.PROJECT_NO}&taskId=${l.WORK_ID}`},n=(l,u)=>{l.stopPropagation(),window.location.href=`/tudio/project/detail?projectNo=${u}`};return N?e.jsx("div",{className:"text-center py-4",children:e.jsx("span",{className:"spinner-border spinner-border-sm text-primary"})}):e.jsxs("div",{className:"widget-content d-flex flex-column h-100 overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 p-3 pb-0",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsxs("h6",{className:"fw-bold m-0 text-dark",children:[e.jsx("i",{className:"bi bi-calendar-check text-primary me-2"}),"Í∞úÏù∏ ÏóÖÎ¨¥"]}),e.jsx("span",{className:"badge bg-light text-secondary border",children:v})]}),e.jsx("div",{className:"d-flex justify-content-between text-center bg-light rounded p-2 mt-3 mb-3",children:m.map((l,u)=>{const C=S===l.dateStr,D=u===0?"text-danger":u===6?"text-primary":"text-dark";return e.jsxs("div",{onClick:()=>y(l.dateStr),className:`calendar-day-box flex-fill p-1 rounded cursor-pointer position-relative ${C?"bg-white shadow-sm border border-primary":""}`,children:[e.jsx("div",{className:`small ${u===0||u===6?D:"text-muted"}`,style:{fontSize:"0.7rem"},children:l.dayName}),e.jsxs("div",{className:`fw-bold mt-1 ${D}`,children:[l.dayNum,l.count>0&&e.jsxs("span",{className:"ms-1 text-primary small",style:{fontSize:"0.75rem",verticalAlign:"top"},children:["[",l.count,"]"]})]})]},l.dateStr)})})]}),e.jsxs("div",{className:"flex-grow-1 overflow-auto custom-scrollbar px-3",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("h6",{className:"small text-muted border-bottom pb-2 mt-3 mb-2",children:["üìÖ ",S," (",p.length,"Í±¥)"]}),e.jsxs("div",{className:"info-icon-wrapper",children:[e.jsx("i",{className:"bi bi-info-circle text-secondary"}),e.jsxs("div",{className:"info-tooltip",children:[e.jsxs("div",{className:"d-flex align-items-center mb-1",children:[e.jsx("i",{className:"bi bi-bookmark-fill text-primary me-2"})," ÏÉÅÏúÑ ÏóÖÎ¨¥"]}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-arrow-return-right text-muted me-2"})," ÌïòÏúÑ ÏóÖÎ¨¥"]})]})]})]}),p.length===0?e.jsx("div",{className:"text-center text-muted py-4 small",children:"ÏòàÏ†ïÎêú ÏóÖÎ¨¥Í∞Ä ÏóÜÏäµÎãàÎã§."}):e.jsx("ul",{className:"list-group list-group-flush px-0 py-0",children:p.map((l,u)=>{const C=h(l.WORK_STATUS);return e.jsxs("li",{className:"list-group-item px-2 py-2 border-0 d-flex align-items-center list-group-item-action",onClick:()=>R(l),style:{cursor:"pointer"},children:[e.jsx("span",{className:"badge bg-light text-dark border me-2 text-truncate",style:{maxWidth:"80px",cursor:"pointer"},onClick:D=>n(D,l.PROJECT_NO),title:"ÌîÑÎ°úÏ†ùÌä∏Î°ú Ïù¥Îèô",children:l.PROJECT_NAME}),e.jsxs("div",{className:"text-truncate flex-grow-1 small fw-bold text-dark",title:l.WORK_TITLE,children:[l.WORK_TYPE==="TASK"?e.jsx("i",{className:"bi bi-bookmark-fill text-primary me-1",style:{fontSize:"0.7rem"}}):e.jsx("i",{className:"bi bi-arrow-return-right text-muted me-1",style:{fontSize:"0.7rem"}}),l.WORK_TITLE]}),e.jsx("span",{className:`badge ${C.color} ms-2`,style:{minWidth:"50px"},children:C.text})]},u)})})]}),e.jsx("div",{className:"flex-shrink-0 p-2 border-top text-end",children:e.jsxs("span",{className:"text-muted small",style:{fontSize:"0.75rem"},children:[e.jsx("i",{className:"bi bi-check2-circle me-1"}),"Ïò§Îäò ÏôÑÎ£å: ",e.jsxs("span",{className:"fw-bold",children:[c.filter(l=>l.WORK_DATE_STR===t()&&l.WORK_STATUS==203).length,"Í±¥"]})]})})]})},K=({refreshTrigger:x})=>{const[c,g]=a.useState({stats:{PENDING_COUNT:0,CONFIRM_COUNT:0,APPROVE_COUNT:0,REJECT_COUNT:0,WAIT_COUNT:0,PROG_COUNT:0,APPROVED_COUNT:0},myDrafts:[],toApprove:[],isClient:!1}),[v,j]=a.useState(!1),[S,y]=a.useState(null),[m,r]=a.useState(null),N=async()=>{try{const l=(await T.get("/tudio/dashboard/approval/data")).data||{},u=l.isClient;g({stats:l.stats||{},myDrafts:l.myDrafts||[],toApprove:l.toApprove||[],isClient:u})}catch(n){console.error("Í≤∞Ïû¨ Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®",n)}finally{j(!1)}};a.useEffect(()=>{N()},[]),a.useEffect(()=>{x>0&&(console.log("‚ôªÔ∏è [Ï†ÑÏûêÍ≤∞Ïû¨] Í∞±Ïã† Ïã†Ìò∏ ÏàòÏã† -> Ïû¨Ï°∞Ìöå"),N())},[x]);const k=n=>{window.location.href=`/tudio/approval/detail?documentNo=${n}`};let h=[],t="",d="";c.isClient?(t="Í≤∞Ïû¨ Í∏∞Ïïà",h=c.toApprove,m==="PENDING"&&(h=h.filter(n=>n.documentStatus===607)),m==="CONFIRM"&&(h=h.filter(n=>n.documentStatus===608)),m==="APPROVE"&&(h=h.filter(n=>n.documentStatus===609)),m==="REJECT"&&(h=h.filter(n=>n.documentStatus===610)),d=m?"Ìï¥Îãπ ÏÉÅÌÉúÏùò Í∏∞ÏïàÏÑúÍ∞Ä ÏóÜÏäµÎãàÎã§.":"ÏöîÏ≤≠Îêú Í≤∞Ïû¨ Í∏∞ÏïàÏÑúÍ∞Ä ÏóÜÏäµÎãàÎã§."):(t="Í∏∞Ïïà ÌòÑÌô©",h=c.myDrafts,m==="WAIT"&&(h=h.filter(n=>n.documentStatus===611)),m==="PROG"&&(h=h.filter(n=>n.documentStatus===612)),m==="REJECT"&&(h=h.filter(n=>n.documentStatus===614)),m==="APPROVED"&&(h=h.filter(n=>n.documentStatus===613)),d=m?"Ìï¥Îãπ ÏÉÅÌÉúÏùò Í∏∞ÏïàÏÑúÍ∞Ä ÏóÜÏäµÎãàÎã§.":"ÏûëÏÑ±Ìïú Í∏∞ÏïàÏÑúÍ∞Ä ÏóÜÏäµÎãàÎã§.");const i=n=>{r(m===n?null:n)},p=n=>{const l=parseInt(n),u={minWidth:"60px"};switch(l){case 607:return e.jsx("span",{className:"badge bg-danger rounded-pill",style:u,children:"ÎØ∏Í≤∞"});case 608:return e.jsx("span",{className:"badge bg-primary rounded-pill",style:u,children:"ÌôïÏù∏"});case 609:return e.jsx("span",{className:"badge bg-success rounded-pill",style:u,children:"ÏäπÏù∏"});case 610:return e.jsx("span",{className:"badge bg-secondary rounded-pill",style:u,children:"Î∞òÎ†§"});case 611:return e.jsx("span",{className:"badge bg-warning text-dark rounded-pill",style:u,children:"ÏäπÏù∏ÎåÄÍ∏∞"});case 612:return e.jsx("span",{className:"badge bg-primary rounded-pill",style:u,children:"ÏßÑÌñâÏ§ë"});case 613:return e.jsx("span",{className:"badge bg-success rounded-pill",style:u,children:"ÏµúÏ¢ÖÏäπÏù∏"});case 614:return e.jsx("span",{className:"badge bg-danger rounded-pill",style:u,children:"Î∞òÎ†§"});case 615:return e.jsx("span",{className:"badge bg-secondary rounded-pill",style:u,children:"ÌöåÏàò"});case 616:return e.jsx("span",{className:"badge bg-light text-dark border rounded-pill",style:u,children:"ÏûÑÏãúÎ≥¥Í¥Ä"});default:return e.jsx("span",{className:"badge bg-light text-dark border rounded-pill",style:u,children:"-"})}},R=n=>{switch(parseInt(n)){case 601:return"ÏûêÏõê/Ïù∏Î†• ÏöîÏ≤≠";case 602:return"ÏùºÏ†ïÎ≥ÄÍ≤Ω ÏöîÏ≤≠";case 603:return"ÏòàÏÇ∞Ï°∞Ï†ï ÏöîÏ≤≠";case 604:return"Í≤ÄÏàòÎ∞èÎ≥¥Í≥†";case 605:return"ÏµúÏ¢ÖÏôÑÎ£åÎ≥¥Í≥†";case 606:return"Í∏∞ÌÉÄ";default:return"ÏùºÎ∞òÍ∏∞Ïïà"}};return v?e.jsx("div",{className:"text-center py-4",children:e.jsx("span",{className:"spinner-border spinner-border-sm text-primary"})}):e.jsxs("div",{className:"widget-content d-flex flex-column h-100 overflow-hidden bg-white",style:{borderRadius:"0.5rem"},children:[e.jsxs("div",{className:"flex-shrink-0 p-3 d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"fw-bold m-0 text-dark",children:[e.jsx("i",{className:"bi bi-file-earmark-check-fill me-2 text-success"}),t]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsxs("span",{className:"badge bg-light text-secondary border",children:[h.length,"Í±¥"]}),e.jsx($,{to:"/tudio/approval/list",className:"text-muted small text-decoration-none ms-1",title:"ÎçîÎ≥¥Í∏∞",children:e.jsx("i",{className:"bi bi-plus-lg"})})]})]}),e.jsx("div",{className:"flex-shrink-0 d-flex border-bottom border-top text-center py-2 bg-light small mx-3 rounded mb-2",children:c.isClient?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`flex-fill border-end py-2 stats-item ${m==="PENDING"?"active":""}`,onClick:()=>i("PENDING"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"ÎØ∏Í≤∞"}),e.jsx("strong",{className:"text-danger",children:c.stats.PENDING_COUNT||0})]}),e.jsxs("div",{className:`flex-fill border-end py-2 stats-item ${m==="CONFIRM"?"active":""}`,onClick:()=>i("CONFIRM"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"ÌôïÏù∏"}),e.jsx("strong",{className:"text-primary",children:c.stats.CONFIRM_COUNT||0})]}),e.jsxs("div",{className:`flex-fill border-end py-2 stats-item ${m==="APPROVE"?"active":""}`,onClick:()=>i("APPROVE"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"ÏäπÏù∏"}),e.jsx("strong",{className:"text-success",children:c.stats.APPROVE_COUNT||0})]}),e.jsxs("div",{className:`flex-fill py-2 stats-item ${m==="REJECT"?"active":""}`,onClick:()=>i("REJECT"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"Î∞òÎ†§"}),e.jsx("strong",{className:"text-secondary",children:c.stats.REJECT_COUNT||0})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`flex-fill border-end py-2 stats-item ${m==="WAIT"?"active":""}`,onClick:()=>i("WAIT"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"ÎåÄÍ∏∞"}),e.jsx("strong",{className:"text-warning",children:c.stats.WAIT_COUNT||0})]}),e.jsxs("div",{className:`flex-fill border-end py-2 stats-item ${m==="PROG"?"active":""}`,onClick:()=>i("PROG"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"ÏßÑÌñâ"}),e.jsx("strong",{className:"text-primary",children:c.stats.PROG_COUNT||0})]}),e.jsxs("div",{className:`flex-fill border-end py-2 stats-item ${m==="REJECT"?"active":""}`,onClick:()=>i("REJECT"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"Î∞òÎ†§"}),e.jsx("strong",{className:"text-secondary",children:c.stats.REJECT_COUNT||0})]}),e.jsxs("div",{className:`flex-fill py-2 stats-item ${m==="APPROVED"?"active":""}`,onClick:()=>i("APPROVED"),children:[e.jsx("span",{className:"text-muted d-block",style:{fontSize:"0.7rem"},children:"ÏäπÏù∏"}),e.jsx("strong",{className:"text-success",children:c.stats.APPROVED_COUNT||0})]})]})}),e.jsx("div",{className:"flex-grow-1 overflow-y-auto custom-scrollbar px-3",style:{minHeight:0},children:h.length===0?e.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center h-75 text-muted small",children:[e.jsx("i",{className:"bi bi-inbox fs-4 mb-2 opacity-50"}),e.jsx("span",{children:d})]}):e.jsx("ul",{className:"list-group list-group-flush pb-2",children:h.map(n=>e.jsxs("li",{className:"list-group-item list-group-item-action py-2 px-2 border-bottom d-flex justify-content-between align-items-center cursor-pointer border-0",onClick:()=>k(n.documentNo),style:{cursor:"pointer"},children:[e.jsx("div",{className:"text-truncate me-2",style:{flex:1},children:e.jsxs("div",{className:"d-flex align-items-center mb-1",children:[e.jsx("span",{className:"badge bg-light text-dark border me-2 text-truncate",style:{fontSize:"0.6rem"},children:R(n.documentType)}),e.jsx("span",{className:"fw-bold text-dark text-truncate small me-2",title:n.documentTitle,children:n.documentTitle}),e.jsxs("span",{className:"text-muted small",style:{fontSize:"0.75rem"},children:["[",c.isClient&&e.jsxs("span",{children:[e.jsx("i",{className:"bi bi-person me-1"}),n.drafterName," / "]}),n.documentRegdate,"]"]})]})}),e.jsx("div",{className:"flex-shrink-0",children:c.isClient&&n.documentStatus===607?e.jsx("button",{className:"btn btn-sm btn-outline-danger py-0 px-2 fw-bold",style:{fontSize:"0.75rem"},children:"Í≤∞Ïû¨"}):p(n.documentStatus)})]},n.documentNo))})}),e.jsx("div",{className:"flex-shrink-0 p-2 border-top text-end",style:{minHeight:"2rem"}})]})},F=({refreshTrigger:x})=>{const[c,g]=a.useState([]),[v,j]=a.useState("ALL"),[S,y]=a.useState({total:0,unread:0});a.useEffect(()=>{m()},[]),a.useEffect(()=>{x>0&&(console.log("‚ôªÔ∏è Alerm Î¶¨Ïä§Ìä∏ Í∞±Ïã†"),m())},[x]);const m=async()=>{try{const d=(await T.get("/tudio/dashboard/alarm")).data;g(d),d.length>0?y({total:d[0].totalCount,unread:d[0].unreadCount}):y({total:0,unread:0})}catch(t){console.error("ÏïåÎ¶º Î°úÎìú Ïã§Ìå®",t)}},r=t=>{if(!t)return"-";const d=new Date(t),i=String(d.getFullYear()).slice(-2),p=String(d.getMonth()+1).padStart(2,"0"),R=String(d.getDate()).padStart(2,"0");return`${i}.${p}.${R}`},N=()=>v==="UNREAD"?c.filter(t=>t.isRead==="N"):v==="READ"?c.filter(t=>t.isRead==="Y"):c,k=async(t,d)=>{const i=d==="Y"?"N":"Y";try{await T.post("/api/dashboard/alarm/status",{notiNo:t,status:i}),m()}catch(p){console.error("ÏÉÅÌÉú Î≥ÄÍ≤Ω Ïã§Ìå®",p)}},h=async t=>{if((await E.fire({title:"ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"ÏÇ≠Ï†ú",cancelButtonText:"Ï∑®ÏÜå",customClass:{popup:"small-swal"}})).isConfirmed)try{await T.post("/api/dashboard/alarm/delete",{notiNo:t}),g(c.filter(i=>i.notiNo!==t)),m()}catch{E.fire("Ïã§Ìå®","ÏÇ≠Ï†ú Ï§ë Ïò§Î•ò Î∞úÏÉù","error")}};return e.jsxs("div",{className:"widget-content",children:[e.jsxs("div",{className:"p-3 border-bottom",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsxs("h6",{className:"fw-bold m-0",children:[e.jsx("i",{className:"bi bi-bell-fill me-2"}),"ÏïåÎ¶º"]}),e.jsxs("div",{className:"d-flex gap-1",children:[e.jsxs("span",{className:"badge bg-light text-secondary border",children:["Ï†ÑÏ≤¥ ",S.total]}),e.jsxs("span",{className:"badge bg-danger",children:["ÏïàÏùΩÏùå ",S.unread]})]})]}),e.jsx("ul",{className:"nav nav-pills nav-fill small gap-1 p-1 bg-light rounded",children:["ALL","UNREAD","READ"].map(t=>e.jsx("li",{className:"nav-item cursor-pointer flex-fill",children:e.jsx("a",{className:`nav-link py-1 ${v===t?"active bg-white text-dark shadow-sm":""}`,onClick:()=>j(t),children:t==="ALL"?"Ï†ÑÏ≤¥":t==="UNREAD"?"ÏïàÏùΩÏùå":"ÏùΩÏùå"})},t))})]}),e.jsx("div",{className:"flex-grow-1 overflow-auto custom-scrollbar p-0",children:N().length===0?e.jsx("div",{className:"text-center text-muted py-5 small",children:"ÏïåÎ¶ºÏù¥ ÏóÜÏäµÎãàÎã§."}):e.jsx("ul",{className:"list-group list-group-flush",children:N().map(t=>e.jsxs("li",{className:`list-group-item list-group-item-action py-3 px-3 border-bottom-0 noti-list ${t.isRead==="N"?"bg-red-50":""}`,children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-1",children:[e.jsxs("div",{className:"text-truncate small",style:{maxWidth:"85%"},children:[t.projectName&&e.jsxs("span",{className:`fw-bold me-1 ${t.projectName==="Í≥µÏßÄÏÇ¨Ìï≠"?"text-danger":"text-primary"}`,children:["[",t.projectName,"]"]}),e.jsxs("span",{className:"text-muted",children:["From. ",t.senderId]})]}),e.jsx("small",{className:"text-muted",style:{fontSize:"0.7rem"},children:r(t.notiRegdate)})]}),e.jsx("div",{className:`mb-2 small ${t.isRead==="N"?"fw-bold text-dark":"text-secondary"}`,children:t.notiMessage}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{className:"btn btn-xs btn-outline-secondary",onClick:()=>k(t.notiNo,t.isRead),title:t.isRead==="Y"?"ÏïàÏùΩÏùå Ï≤òÎ¶¨":"ÏùΩÏùå Ï≤òÎ¶¨",children:e.jsx("i",{className:`bi ${t.isRead==="Y"?"bi-envelope":"bi-envelope-open"}`})}),e.jsx("button",{className:"btn btn-xs btn-outline-danger",onClick:()=>h(t.notiNo),children:e.jsx("i",{className:"bi bi-trash"})})]})]},t.notiNo))})})]})},L=Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:x=>{x.addEventListener("mouseenter",Swal.stopTimer),x.addEventListener("mouseleave",Swal.resumeTimer)}}),Y=({onProjectSelect:x,refreshTrigger:c})=>{const[g,v]=a.useState([]),[j,S]=a.useState(!0);a.useEffect(()=>{y()},[]),a.useEffect(()=>{c>0&&(console.log("‚ôªÔ∏è ÏÜåÏºì Ïã†Ìò∏ Í∞êÏßÄ: Î™©Î°ù ÏÉàÎ°úÍ≥†Ïπ®"),y())},[c]);const y=async()=>{try{const t=await T.get("/tudio/dashboard/bookmark/list");v(t.data)}catch(t){console.error("Î∂ÅÎßàÌÅ¨ Î°úÎìú Ïã§Ìå®",t)}finally{S(!1)}},m=async(t,d)=>{t.stopPropagation();const i=[...g];v(i.filter(p=>p.projectNo!==d));try{const p=await T.post("/tudio/project/bookmark",{projectNo:d});if(p.data&&p.data.status==="SUCCESS")L.fire({icon:"success",title:"Î∂ÅÎßàÌÅ¨Í∞Ä Ìï¥Ï†úÎêòÏóàÏäµÎãàÎã§."}),console.log("Î∂ÅÎßàÌÅ¨ Ìï¥Ï†ú ÏôÑÎ£å");else throw new Error("Server returned status: "+(p.data?p.data.status:"Unknown"))}catch(p){console.error("Î∂ÅÎßàÌÅ¨ Î≥ÄÍ≤Ω Ïã§Ìå®",p),v(i),L.fire({icon:"error",title:"Î∂ÅÎßàÌÅ¨ Î≥ÄÍ≤Ω Ïã§Ìå®"})}},r=t=>{if(!t)return"-";const d=new Date(t),i=String(d.getFullYear()).slice(-2),p=String(d.getMonth()+1).padStart(2,"0"),R=String(d.getDate()).padStart(2,"0");return`${i}.${p}.${R}`},N=(t,d)=>{const i=Number(t)||0,p=Number(d)||0;return i===0?0:Math.round(p/i*100)},k=(t,d)=>{if(!t||!d)return 0;const i=new Date(t).getTime(),p=new Date(d).getTime(),R=new Date().getTime(),n=p-i,l=R-i;if(n<=0)return 100;if(l<0)return 0;const u=Math.round(l/n*100);return u>100?100:u},h=t=>{const d="badge rounded-pill ms-1",i={fontSize:"0.6rem",padding:"0.25em 0.6em"};return t===1?e.jsx("span",{className:`${d} bg-success`,style:i,children:"ÏôÑÎ£å"}):t===2?e.jsx("span",{className:`${d} bg-secondary`,style:i,children:"Ï§ëÎã®"}):e.jsx("span",{className:`${d} bg-primary`,style:i,children:"ÏßÑÌñâ"})};return j?e.jsx("div",{className:"text-center py-4",children:e.jsx("span",{className:"spinner-border spinner-border-sm text-primary"})}):e.jsxs("div",{className:"widget-content d-flex flex-column h-100 overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 p-3 border-bottom d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"fw-bold m-0 text-dark",children:[e.jsx("i",{className:"bi bi-bookmark-star-fill text-info me-2"}),"Î∂ÅÎßàÌÅ¨ ÌîÑÎ°úÏ†ùÌä∏"]}),e.jsx("span",{className:"badge bg-light text-secondary border",children:g.length})]}),e.jsx("div",{className:"flex-grow-1 overflow-auto custom-scrollbar",style:{minHeight:0},children:j?e.jsxs("div",{className:"d-flex justify-content-center align-items-center h-100 text-muted",children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2"})," Î°úÎî©Ï§ë..."]}):g.length===0?e.jsxs("div",{className:"text-center text-muted py-5 small",children:[e.jsx("i",{className:"bi bi-star d-block fs-3 mb-2 opacity-50"}),"Î∂ÅÎßàÌÅ¨Ìïú ÌîÑÎ°úÏ†ùÌä∏Í∞Ä ÏóÜÏäµÎãàÎã§."]}):e.jsx("ul",{className:"list-group list-group-flush gap-1",children:g.map(t=>{const d=N(t.myTotalTaskCount,t.myDoneTaskCount),i=k(t.projectStartdate,t.projectEnddate);return e.jsxs("li",{className:"list-group-item list-group-item-action px-3 d-flex cursor-pointer",onClick:()=>x(t.projectNo),style:{cursor:"pointer"},children:[e.jsxs("div",{className:"d-flex align-items-center overflow-hidden me-2",style:{width:"35%",minWidth:0},children:[e.jsx("button",{className:"btn btn-link p-0 text-warning border-0 flex-shrink-0 me-2",style:{lineHeight:0},onClick:p=>m(p,t.projectNo),title:"Î∂ÅÎßàÌÅ¨ Ìï¥Ï†ú",children:e.jsx("i",{className:"bi bi-star-fill fs-6"})}),e.jsxs("div",{className:"d-flex overflow-hidden align-items-center",children:[e.jsx("div",{className:"fw-bold text-dark text-truncate",title:t.projectName,style:{fontSize:"0.9rem"},children:t.projectName}),h(t.projectStatus)]})]}),e.jsxs("div",{className:"d-flex flex-column justify-content-center border-start ps-3",style:{width:"65%"},children:[e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",style:{fontSize:"0.75rem"},children:[e.jsx("span",{className:"text-primary fw-bold",children:"ÎÇ¥ ÏóÖÎ¨¥"}),e.jsxs("span",{className:"fw-bold small",children:[d,"% ",e.jsxs("span",{className:"text-muted fw-light",children:["(",t.myDoneTaskCount,"/",t.myTotalTaskCount,")"]})]})]}),e.jsx("div",{className:"progress",style:{height:"6px",backgroundColor:"#fff"},children:e.jsx("div",{className:"progress-bar bg-primary",style:{width:`${d}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",style:{fontSize:"0.75rem"},children:[e.jsx("span",{className:"text-primary fw-bold",children:"ÌîÑÎ°úÏ†ùÌä∏ ÏßÑÏ≤ôÎèÑ"}),e.jsxs("span",{className:"text-dark small",children:[i,"%"]})]}),e.jsx("div",{className:"progress mb-1",style:{height:"4px",backgroundColor:"#fff"},children:e.jsx("div",{className:"progress-bar bg-secondary opacity-50",style:{width:`${i}%`}})}),e.jsxs("div",{className:"text-muted text-end",style:{fontSize:"0.65rem",whiteSpace:"nowrap"},children:[r(t.projectStartdate)," ~ ",r(t.projectEnddate)]})]})]})]},t.projectNo)})})}),e.jsx("div",{className:"flex-shrink-0 p-2 border-top text-end",style:{minHeight:"2rem"}})]})},P=E.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1e3,timerProgressBar:!0,didOpen:x=>{x.addEventListener("mouseenter",E.stopTimer),x.addEventListener("mouseleave",E.resumeTimer)}}),J=({projectNo:x,refreshTrigger:c})=>{const[g,v]=a.useState([]),[j,S]=a.useState(!1),[y,m]=a.useState(!1),[r,N]=a.useState(""),[k,h]=a.useState(null),[t,d]=a.useState(""),i=a.useRef(null),p=a.useRef(null);a.useEffect(()=>{R(),m(!1),h(null)},[x]),a.useEffect(()=>{c>0&&(console.log("‚ôªÔ∏è [TodoWidget] Í∞±Ïã† Ïã†Ìò∏ ÏàòÏã†"),R())},[c]),a.useEffect(()=>{y&&i.current&&i.current.focus()},[y]),a.useEffect(()=>{k&&p.current&&p.current.focus()},[k]);const R=async()=>{try{const o=await T.get("/tudio/dashboard/todo/list",{params:{projectNo:x||0}});v(o.data||[])}catch(o){console.error("Ìà¨Îëê Î°úÎìú Ïã§Ìå®",o)}finally{S(!1)}},n=async()=>{if(!r.trim()){E.fire({icon:"warning",title:"ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.",toast:!0,position:"top-end",timer:1500,showConfirmButton:!1});return}try{(await T.post("/tudio/dashboard/todo/insert",{todoContent:r,projectNo:x||0})).data==="OK"?(P.fire({icon:"success",title:"Ìï† ÏùºÏù¥ Îì±Î°ùÎêòÏóàÏäµÎãàÎã§."}),N(""),R(),i.current&&i.current.focus()):E.fire("Ïã§Ìå®","Îì±Î°ùÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.","error")}catch(o){console.error("Îì±Î°ù ÏóêÎü¨",o),E.fire("ÏóêÎü¨","ÏÑúÎ≤Ñ ÌÜµÏã† Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.","error")}},l=async o=>{const s=o.todoStatus==="Y"?"N":"Y",f=[...g];v(g.map(w=>w.todoNo===o.todoNo?{...w,todoStatus:s}:w));try{const w=await T.post("/tudio/dashboard/todo/updateStatus",{todoNo:o.todoNo,todoStatus:s});if(console.log(w.data),w.status===200&&w.data==="OK")console.log("‚úÖ ÏÑ±Í≥µ");else throw new Error("DB ÏóÖÎç∞Ïù¥Ìä∏ Ïã§Ìå® (0Í±¥ ÏàòÏ†ïÎê®)")}catch(w){v(f),console.error("ÏÉÅÌÉú Î≥ÄÍ≤Ω Ïã§Ìå®",w),E.fire("Ïò§Î•ò","ÏÉÅÌÉú Î≥ÄÍ≤Ω Ïã§Ìå®","error")}},u=async o=>{if((await E.fire({title:"Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?",text:"ÏÇ≠Ï†úÎêú Îç∞Ïù¥ÌÑ∞Îäî Î≥µÍµ¨Ìï† Ïàò ÏóÜÏäµÎãàÎã§.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"ÎÑ§, ÏÇ≠Ï†úÌï©ÎãàÎã§",cancelButtonText:"Ï∑®ÏÜå",customClass:{popup:"small-swal"}})).isConfirmed)try{(await T.post("/tudio/dashboard/todo/delete",{todoNo:o})).data==="OK"?(P.fire({icon:"success",title:"ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§."}),v(g.filter(w=>w.todoNo!==o))):E.fire("Ïò§Î•ò","ÏÇ≠Ï†ú Ïã§Ìå®","error")}catch{E.fire("Ïò§Î•ò","ÏÑúÎ≤Ñ ÌÜµÏã† Ïã§Ìå®","error")}},C=o=>{h(o.todoNo),d(o.todoContent)},D=async()=>{if(!t.trim()){E.fire({icon:"warning",title:"ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî."});return}try{(await T.post("/tudio/dashboard/todo/updateContent",{todoNo:k,todoContent:t})).data==="OK"?(P.fire({icon:"success",title:"ÏàòÏ†ï ÏôÑÎ£å"}),v(g.map(s=>s.todoNo===k?{...s,todoContent:t}:s)),h(null)):E.fire("Ïã§Ìå®","ÏàòÏ†ï Ïã§Ìå®","error")}catch(o){console.error("ÏàòÏ†ï Ïã§Ìå®",o)}};return e.jsxs("div",{className:"widget-content zen-folder-widget bg-white d-flex flex-column rounded shadow-sm position-relative",style:{height:"100%",width:"100%",overflow:"hidden"},children:[e.jsxs("div",{className:"folder-shape-layer",style:{position:"absolute",inset:0,zIndex:0},children:[e.jsx("div",{className:"folder-tab-todo"}),e.jsx("div",{className:"folder-body-bg"})]}),e.jsxs("div",{className:"folder-content-layer d-flex flex-column h-100 position-relative",style:{zIndex:1,paddingLeft:"6px"},children:[e.jsx("div",{className:"widget-header-wrapper",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center widget-header-custom",children:[e.jsxs("h6",{className:"font-weight-bold m-0 text-gray-800",style:{padding:"14px 20px"},children:[e.jsx("i",{className:"bi bi-check2-square text-primary me-2"}),"To Do List",x>0&&e.jsxs("span",{className:"ms-2 badge bg-primary rounded-pill",children:["Prj.",x]})]}),e.jsx("button",{className:"btn btn-sm btn-white shadow-sm border rounded-circle d-flex align-items-center justify-content-center",onClick:()=>m(!y),title:"Ìï† Ïùº Ï∂îÍ∞Ä",style:{width:"32px",height:"32px",backgroud:"#fff"},children:e.jsx("i",{className:`bi ${y?"bi-x-lg text-danger":"bi-plus-lg text-primary fw-bold"}`})})]})}),y&&e.jsx("div",{className:"px-3 mb-2 animate-fade-in",children:e.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center bg-light border rounded p-2",children:[e.jsx("div",{className:"d-flex align-items-center w-100 me-2",children:e.jsx("input",{type:"text",ref:i,className:"form-control form-control-sm",placeholder:"Ìï† Ïùº Ï∂îÍ∞Ä",value:r,onChange:o=>N(o.target.value),onKeyDown:o=>{o.key==="Enter"&&n(),o.key==="Escape"&&m(!1)}})}),e.jsxs("div",{className:"d-flex",style:{minWidth:"100px"},children:[e.jsx("button",{className:"btn btn-sm btn-success me-1",onClick:n,children:"Ï∂îÍ∞Ä"}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>m(!1),children:"Ï∑®ÏÜå"})]})]})}),e.jsx("div",{className:"flex-grow-1 overflow-auto custom-scrollbar px-0",id:`todo-list-area-${x}`,style:{minHeight:0},children:j?e.jsx("div",{className:"text-center py-4 text-muted small",children:"Î°úÎî©Ï§ë..."}):g.length===0?e.jsx("div",{className:"text-center py-5 text-muted small",children:"Îì±Î°ùÎêú Ìï† ÏùºÏù¥ ÏóÜÏäµÎãàÎã§."}):e.jsx("ul",{className:"list-group list-group-flush",children:g.map(o=>e.jsxs("li",{className:"list-group-item px-3 py-2 border-bottom-0 d-flex align-items-center group-hover-target",onMouseEnter:s=>s.currentTarget.classList.add("bg-light"),onMouseLeave:s=>s.currentTarget.classList.remove("bg-light"),children:[e.jsxs("div",{className:"form-check m-0 d-flex align-items-center flex-grow-1 text-truncate",style:{maxWidth:"80%"},children:[e.jsx("input",{className:"form-check-input cursor-pointer mt-0",type:"checkbox",id:`todoCheck${o.todoNo}`,checked:o.todoStatus==="Y",onChange:()=>l(o)}),k===o.todoNo?e.jsxs("div",{className:"d-flex ms-2 w-100 align-items-center",children:[e.jsx("input",{type:"text",ref:p,className:"form-control form-control-sm me-2",value:t,onChange:s=>d(s.target.value),onKeyDown:s=>{s.key==="Enter"&&D(),s.key==="Escape"&&h(null)}}),e.jsx("button",{className:"btn btn-sm btn-success me-1 text-nowrap",onClick:D,children:"Ï†ÄÏû•"}),e.jsx("button",{className:"btn btn-sm btn-secondary text-nowrap",onClick:()=>h(null),children:"Ï∑®ÏÜå"})]}):e.jsx("label",{className:`form-check-label ms-2 cursor-pointer text-truncate ${o.todoStatus==="Y"?"text-decoration-line-through text-muted":""}`,htmlFor:`todoCheck${o.todoNo}`,onDoubleClick:()=>C(o),style:{fontSize:"0.9rem",width:"100%"},title:o.todoContent,children:o.todoContent})]}),k!==o.todoNo&&e.jsxs("div",{className:"btn-group btn-group-sm opacity-50 group-hover-visible transition-opacity ms-auto",children:[e.jsx("button",{type:"button",className:"btn btn-link text-secondary p-0 me-2",onClick:()=>C(o),title:"ÏàòÏ†ï",children:e.jsx("i",{className:"bi bi-pencil-square"})}),e.jsx("button",{type:"button",className:"btn btn-link text-danger p-0",onClick:()=>u(o.todoNo),title:"ÏÇ≠Ï†ú",children:e.jsx("i",{className:"bi bi-trash"})})]})]},o.todoNo))})})]})]})},G=()=>{const[x,c]=a.useState([]);return a.useEffect(()=>{T.get("/tudio/dashboard/survey/pending").then(g=>{Array.isArray(g.data)?c(g.data):c([])}).catch(g=>{console.error("ÏÑ§Î¨∏ Î°úÎìú Ïã§Ìå®",g),c([])})},[]),!x||x.length===0?null:e.jsxs("div",{className:"alert alert-primary d-flex align-items-center justify-content-between mb-4 shadow-sm border-0",role:"alert",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-clipboard-check-fill fs-4 me-3 text-primary"}),e.jsxs("div",{children:[e.jsxs("strong",{children:["ÎØ∏Ï∞∏Ïó¨ ÏÑ§Î¨∏Ïù¥ ",x.length,"Í±¥ ÏûàÏäµÎãàÎã§!"]}),e.jsx("div",{className:"small text-muted",children:"ÏÜåÏ§ëÌïú ÏùòÍ≤¨ÏùÑ ÎÇ®Í≤®Ï£ºÏÑ∏Ïöî."})]})]}),e.jsx("div",{className:"d-flex gap-2",children:(x||[]).slice(0,2).map(g=>e.jsxs($,{to:`/tudio/survey/detail/${g.surveyNo}`,className:"btn btn-sm btn-light text-primary fw-bold border",children:[g.surveyTitle," ",e.jsx("i",{className:"bi bi-arrow-right ms-1"})]},g.surveyNo))})]})},H=({refreshTrigger:x})=>{const[c,g]=a.useState([]),[v,j]=a.useState(!0),S=()=>{T.get("/tudio/dashboard/notice").then(r=>{g(r.data||[])}).catch(r=>console.error("Í≥µÏßÄÏÇ¨Ìï≠ Î°úÎìú Ïã§Ìå®",r)).finally(()=>j(!1))};a.useEffect(()=>{S()},[]),a.useEffect(()=>{x>0&&(console.log("‚ôªÔ∏è [Í≥µÏßÄÏÇ¨Ìï≠] Í∞±Ïã† Ïã†Ìò∏ ÏàòÏã† -> Ïû¨Ï°∞Ìöå"),S())},[x]);const y=r=>{window.location.href=`/tudio/notice/detail?noticeNo=${r}`},m=r=>{if(!r)return"-";const N=new Date(r),k=String(N.getFullYear()).slice(-2),h=String(N.getMonth()+1).padStart(2,"0"),t=String(N.getDate()).padStart(2,"0");return`${k}.${h}.${t}`};return v?e.jsx("div",{className:"text-center py-4",children:e.jsx("span",{className:"spinner-border spinner-border-sm text-warning"})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"widget-content d-flex flex-column h-100 overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 p-3 border-bottom d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"fw-bold m-0",children:[e.jsx("i",{className:"bi bi-megaphone-fill me-2 text-warning"}),"ÏãúÏä§ÌÖú Í≥µÏßÄÏÇ¨Ìï≠"]}),e.jsx($,{to:"/board/notice",className:"text-muted small text-decoration-none",title:"ÎçîÎ≥¥Í∏∞",children:e.jsx("i",{className:"bi bi-plus-lg"})})]}),e.jsx("div",{className:"flex-grow-1 overflow-y-auto custom-scrollbar",style:{minHeight:0},children:c.length===0?e.jsxs("div",{className:"d-flex align-items-center justify-content-center h-100 text-muted small",children:[e.jsx("i",{className:"bi bi-exclamation-circle fs-4 mx-2 opacity-50"}),e.jsx("span",{children:"Îì±Î°ùÎêú Í≥µÏßÄÏÇ¨Ìï≠Ïù¥ ÏóÜÏäµÎãàÎã§."})]}):e.jsx("ul",{className:"list-group list-group-flush",children:c.map(r=>e.jsxs("li",{className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center px-3 py-3",children:[e.jsxs("div",{className:"d-flex align-items-center overflow-hidden me-2",style:{flex:1},children:[r.noticeFixStatus==="Y"&&e.jsx("i",{className:"bi bi-pin-angle-fill text-danger me-2 small flex-shrink-0",title:"Ï§ëÏöî Í≥µÏßÄ"}),e.jsx("span",{className:"notice-title text-dark small fw-bold text-truncate cursor-pointer",onClick:()=>y(r.noticeNo),style:{cursor:"pointer"},title:r.noticeTitle,children:r.noticeTitle}),new Date(r.noticeRegdate).toDateString()===new Date().toDateString()&&e.jsx("span",{className:"badge bg-danger rounded-pill ms-2",style:{fontSize:"0.5rem",padding:"0.2em 0.4em"},children:"New"})]}),e.jsxs("div",{className:"d-flex align-items-center flex-shrink-0",style:{fontSize:"0.75rem"},children:[e.jsxs("span",{className:"text-secondary me-2 fw-bold",children:[e.jsx("i",{className:"bi bi-person me-1 text-muted"}),r.writer||"Í¥ÄÎ¶¨Ïûê"]}),e.jsx("span",{className:"text-muted small bg-light border px-2 py-1 rounded",children:m(r.noticeRegdate)})]})]},r.noticeNo))})}),e.jsx("div",{className:"flex-shrink-0 p-2 border-top text-end",style:{minHeight:"2rem"}})]})})},V=({refreshTrigger:x})=>{const[c,g]=a.useState([]),[v,j]=a.useState(!0),S=()=>{T.get("/tudio/dashboard/deadlineWork").then(r=>{console.log("ÎßàÍ∞êÏûÑÎ∞ï Îç∞Ïù¥ÌÑ∞ ÌôïÏù∏:",r.data),g(r.data||[])}).catch(r=>console.error("ÎßàÍ∞êÏûÑÎ∞ï Î°úÎìú Ïã§Ìå®",r)).finally(()=>j(!1))};if(a.useEffect(()=>{S()},[]),a.useEffect(()=>{x>0&&(console.log("‚ôªÔ∏è [ÎßàÍ∞êÏûÑÎ∞ï] Í∞±Ïã† Ïã†Ìò∏ ÏàòÏã† -> Ïû¨Ï°∞Ìöå"),S())},[x]),v)return e.jsx("div",{className:"text-center py-4",children:e.jsx("span",{className:"spinner-border spinner-border-sm text-danger"})});const y=r=>r<0?e.jsxs("span",{className:"badge bg-danger rounded-pill",children:["D+",Math.abs(r)]}):r===0?e.jsx("span",{className:"badge bg-danger rounded-pill",children:"D-Day"}):e.jsxs("span",{className:"badge bg-warning text-dark rounded-pill",children:["D-",r]}),m=r=>{window.location.href=`tudio/project/detail?projectNo=${r}`};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"widget-content",children:[e.jsxs("div",{className:"p-3 border-bottom d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"fw-bold m-0 text-dark",children:[e.jsx("i",{className:"bi bi-stopwatch-fill me-2"}),"ÎßàÍ∞ê ÏûÑÎ∞ï ÏóÖÎ¨¥"]}),e.jsxs("span",{className:"badge bg-danger rounded-pill",children:[c.length,"Í±¥"]})]}),e.jsx("div",{className:"flex-grow-1 overflow-auto custom-scrollbar p-0",style:{minHeight:0},children:v?e.jsx("div",{className:"text-center py-5",children:e.jsx("span",{className:"spinner-border spinner-border-sm text-danger"})}):e.jsx("ul",{className:"list-group list-group-flush",children:c.length===0?e.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center h-100 text-muted small py-5",children:[e.jsx("i",{className:"bi bi-check-circle fs-4 mb-2 text-success"}),e.jsx("span",{children:"ÎßàÍ∞ê ÏûÑÎ∞ïÌïú ÏóÖÎ¨¥Í∞Ä ÏóÜÏäµÎãàÎã§."})]}):c.map((r,N)=>e.jsxs("li",{className:"list-group-item list-group-item-action px-3 py-3",children:[e.jsxs("div",{className:"text-muted mb-1 d-flex align-items-center",style:{fontSize:"0.75rem"},children:[e.jsx("i",{className:"bi bi-folder2-open me-1"}),e.jsx("span",{className:"text-truncate",onClick:()=>m(r.projectNo),style:{cursor:"pointer"},children:r.projectName})]}),e.jsxs("div",{className:"d-flex align-items-center w-100 gap-2",children:[e.jsx("div",{className:"fw-bold text-dark text-truncate",style:{flex:"0 0 35%",fontSize:"0.9rem"},title:r.taskTitle,children:r.taskTitle}),e.jsxs("div",{className:"d-flex align-items-center",style:{flex:"1 1 auto",minWidth:0},children:[e.jsx("div",{className:"progress w-100",style:{height:"6px",backgroundColor:"#e9ecef",borderRadius:"3px"},children:e.jsx("div",{className:`progress-bar ${r.taskDday<0?"bg-danger":"bg-warning"}`,style:{width:`${r.taskRate}%`}})}),e.jsxs("small",{className:"ms-2 fw-bold text-secondary",style:{fontSize:"0.75rem",minWidth:"30px",textAlign:"right"},children:[r.taskRate,"%"]})]}),e.jsx("div",{className:"d-flex justify-content-end",style:{flex:"0 0 auto"},children:y(r.taskDday)})]})]},N))})})]})})},Z=()=>{const[x,c]=a.useState([]),[g,v]=a.useState([]),[j,S]=a.useState(!1),y=a.useRef(null),[m,r]=a.useState(0),[N,k]=a.useState({PERSONAL_WORK:0,DRAFT:0,ALARM:0,PROJECT_BOOKMARK:0,TODO:0,NOTICE:0,PROJECT_SUMMARY:0}),h=document.body.dataset.contextPath||"",t=document.body.dataset.loginNo?parseInt(document.body.dataset.loginNo,10):0;a.useEffect(()=>{const s=document.getElementById("mainContent");if(s)return j?s.classList.add("dashboard-edit-mode"):s.classList.remove("dashboard-edit-mode"),()=>s.classList.remove("dashboard-edit-mode")},[j]),a.useEffect(()=>{(async()=>{try{const f=await T.get("/tudio/dashboard/layout"),w=Array.isArray(f.data)?f.data:[];c(w.filter(b=>b.widgetStatus==="Y")),v(w.filter(b=>b.widgetStatus==="N"))}catch(f){console.error("Layout fetch error",f)}})()},[]),a.useEffect(()=>{if(x.length===0)return;const s=document.querySelector(".grid-stack");if(!s||y.current)return;console.log("Grid Container Width:",s.offsetWidth);const f=_.init({column:12,cellHeight:100,margin:10,disableOneColumnMode:!0,animate:!0,float:!1,staticGrid:!j,removable:!1,children:!1,minRow:5,resizable:{handles:"n, e, s, w, nw, sw, se"}},s);return y.current=f,()=>{f&&(f.destroy(!1),y.current=null)}},[x]),a.useEffect(()=>{y.current&&(y.current.setStatic(!j),j&&setTimeout(()=>{window.dispatchEvent(new Event("resize")),console.log("Triggered window resize for GridStack")},320))},[j]);const d=(s,f)=>{s.dataTransfer.setData("widget-data",JSON.stringify(f)),s.dataTransfer.effectAllowed="copy",document.body.style.cursor="grabbing"},i=()=>{document.body.style.cursor="auto",document.querySelector(".grid-stack")?.classList.remove("drag-over")},p=s=>{s.preventDefault(),s.stopPropagation(),s.dataTransfer.dropEffect="copy",s.currentTarget.classList.add("drag-over")},R=s=>{s.preventDefault(),s.currentTarget.classList.remove("drag-over"),document.body.style.cursor="auto";const f=s.dataTransfer.getData("widget-data");if(!f)return;const w=JSON.parse(f);v(b=>b.filter(O=>String(O.widgetNo)!==String(w.widgetNo))),c(b=>b.some(O=>String(O.widgetNo)===String(w.widgetNo))?b:[...b,{...w,x:0,y:0,widgetStatus:"Y",autoPosition:!0}])},n=a.useCallback(s=>{S(s)},[]),l=s=>{c(f=>{const w=f.find(b=>b.widgetNo==s);return w?(v(b=>[...b,{...w,x:0,y:0,widgetStatus:"N"}]),f.filter(b=>b.widgetNo!=s)):f})},u=async()=>{if(!y.current)return;const f=y.current.save(!1).map(b=>({widgetNo:b.id,x:b.x,y:b.y,width:b.w,height:b.h,widgetStatus:"Y"})),w=g.map(b=>({widgetNo:b.widgetNo,x:0,y:0,width:b.width,height:b.height,widgetStatus:"N"}));try{await T.post("/tudio/dashboard/layout/save",[...f,...w]),E.fire({icon:"success",title:"Ï†ÄÏû• ÏôÑÎ£å",text:"Î†àÏù¥ÏïÑÏõÉÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.",timer:1500,showConfirmButton:!1}),n(!1)}catch{E.fire("Ïò§Î•ò","Ï†ÄÏû• Ïã§Ìå®","error")}};a.useEffect(()=>{if(!t)return;const s=new z(`${h}/ws-stomp`),f=B.over(s);return f.debug=null,f.connect({},()=>{console.log(`‚úÖ WebSocket Connected (Member: ${t})`),f.subscribe(`/sub/dashboard/${t}`,w=>{const O=JSON.parse(w.body).type;O&&N.hasOwnProperty(O)&&(console.log(`‚ôªÔ∏è [${O}] ÏúÑÏ†Ø Í∞±Ïã† Ïã†Ìò∏ ÏàòÏã†`),k(A=>({...A,[O]:A[O]+1})))})}),()=>{f&&f.disconnect()}},[h,t]);const C=s=>o[s]?.title||"ÏúÑÏ†Ø",D=s=>o[s]?.icon||"bi-grid",o=a.useMemo(()=>({PERSONAL_WORK:{component:e.jsx(U,{refreshTrigger:N.PERSONAL_WORK}),title:"Í∞úÏù∏ ÏóÖÎ¨¥",icon:"bi-calendar-week"},DRAFT:{component:e.jsx(K,{refreshTrigger:N.DRAFT}),title:"Ï†ÑÏûêÍ≤∞Ïû¨",icon:"bi-file-earmark-text"},ALARM:{component:e.jsx(F,{refreshTrigger:N.ALARM}),title:"ÎØ∏ÌôïÏù∏ ÏïåÎ¶º",icon:"bi-bell-fill"},PROJECT_BOOKMARK:{component:e.jsx(Y,{onProjectSelect:r,refreshTrigger:N.PROJECT_BOOKMARK}),title:"Î∂ÅÎßàÌÅ¨ ÌîÑÎ°úÏ†ùÌä∏",icon:"bi-bookmark-star-fill"},TODO:{component:e.jsx(J,{projectNo:m,refreshTrigger:N.TODO}),title:"To Do List",icon:"bi-check2-square"},NOTICE:{component:e.jsx(H,{refreshTrigger:N.NOTICE}),title:"ÏãúÏä§ÌÖú Í≥µÏßÄÏÇ¨Ìï≠",icon:"bi-megaphone-fill"},PROJECT_SUMMARY:{component:e.jsx(V,{refreshTrigger:N.PROJECT_SUMMARY}),title:"ÎßàÍ∞ê ÏûÑÎ∞ï ÏóÖÎ¨¥",icon:"bi-stopwatch"}}),[m,N]);return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("svg",{width:"0",height:"0",style:{position:"absolute",visibility:"hidden",pointerEvents:"none"},children:e.jsx("defs",{children:e.jsxs("filter",{id:"filter-svg",children:[e.jsx("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"5",result:"blur"}),e.jsx("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 19 -9",result:"goo"}),e.jsx("feComposite",{in:"SourceGraphic",in2:"goo",operator:"atop"})]})})}),e.jsxs("div",{className:"dashboard-content-wrapper",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3 px-4 pt-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"fw-bold text-primary-dark mb-2",style:{color:"#00407F"},children:"ÎåÄÏãúÎ≥¥Îìú"}),e.jsx("p",{className:"text-muted small m-0",children:"TudioÏôÄ Ìï®Íªò ÌôúÍ∏∞Ï∞®Í≤å ÏóÖÎ¨¥Î•º ÏãúÏûëÌï¥Î≥¥ÏÑ∏Ïöî !"})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("div",{className:"bg-white rounded-pill px-3 py-2 d-flex align-items-center border shadow-sm gap-3",children:e.jsxs("div",{className:"form-check form-switch m-0",children:[e.jsx("input",{className:"form-check-input cursor-pointer",type:"checkbox",id:"editModeSwitch",checked:j,onChange:s=>n(s.target.checked)}),e.jsx("label",{className:"form-check-label small fw-bold ms-2 cursor-pointer",htmlFor:"editModeSwitch",children:"ÏúÑÏ†Ø Ìé∏Ïßë"})]})}),j&&e.jsxs("button",{className:"btn btn-sm btn-primary rounded-pill px-3 py-2 fw-bold shadow-sm",onClick:u,children:[e.jsx("i",{className:"bi bi-check-lg me-1"})," Ï†ÄÏû•"]})]})]}),e.jsx("div",{className:"px-4",children:e.jsx(G,{})}),e.jsx("div",{className:"main-content-wrapper px-3",children:e.jsx("div",{className:"grid-stack",style:{minHeight:"600px"},onDragOver:j?p:void 0,onDrop:j?R:void 0,children:x.map(s=>e.jsx("div",{className:"grid-stack-item","gs-id":s.widgetNo,"gs-x":s.x,"gs-y":s.y,"gs-w":s.width,"gs-h":s.height,"gs-auto-position":s.autoPosition?"true":void 0,"data-type":s.widgetType,children:e.jsxs("div",{className:"grid-stack-item-content",children:[j&&e.jsx("div",{className:"btn-close-widget",onClick:()=>l(s.widgetNo),children:e.jsx("i",{className:"bi bi-x-lg"})}),o[s.widgetType]?.component]})},s.widgetNo))})})]}),e.jsxs("div",{className:`widget-drawer ${j?"open":""}`,children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4 p-3",children:[e.jsxs("h5",{className:"fw-bold m-0",children:[e.jsx("i",{className:"bi bi-box-seam me-2"})," ÏúÑÏ†Ø Î≥¥Í¥ÄÌï®"]}),e.jsx("button",{className:"btn-close",onClick:()=>n(!1)})]}),e.jsx("div",{id:"sidebar-content",className:"px-3 pb-3 h-100 overflow-auto",children:g.map(s=>e.jsx("div",{className:"sidebar-widget-item mb-3 cursor-grab","gs-id":s.widgetNo,"gs-w":s.width,"gs-h":s.height,"data-type":s.widgetType,draggable:!0,onDragStart:f=>d(f,s),onDragEnd:i,style:{cursor:"grab"},children:e.jsxs("div",{className:"grid-stack-item-content w-100",style:{pointerEvents:"none"},children:[e.jsxs("span",{className:"fw-bold text-dark small",children:[e.jsx("i",{className:`bi ${D(s.widgetType)} me-2 text-primary`}),C(s.widgetType)]}),e.jsx("i",{className:"bi bi-grip-vertical text-muted"})]})},s.widgetNo))})]})]})};export{Z as D};
